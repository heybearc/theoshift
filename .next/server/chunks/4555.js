exports.id=4555,exports.ids=[4555],exports.modules={9927:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var r=s(997),a=s(1649),l=s(1664),n=s.n(l),i=s(1163);function d({children:e,title:t="JW Attendant Scheduler",breadcrumbs:s=[],selectedEvent:l}){let{data:d}=(0,a.useSession)(),c=(0,i.useRouter)(),o=[{label:"Events",href:"/events",icon:"\uD83D\uDCC5",roles:["ADMIN","OVERSEER","ATTENDANT"]},{label:"Event Selection",href:"/events/select",icon:"\uD83C\uDFAF",roles:["ADMIN","OVERSEER","ATTENDANT"]}];["ADMIN","OVERSEER"].includes(d?.user?.role||"")&&o.push({label:"Attendants",href:"/attendants",icon:"\uD83D\uDC65",roles:["ADMIN","OVERSEER"]}),d?.user?.role==="ADMIN"&&o.push({label:"Admin Portal",href:"/admin",icon:"\uD83D\uDEE1ï¸",roles:["ADMIN"]});let m=o.filter(e=>e.roles.includes(d?.user?.role||""));return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)(n(),{href:"/events/select",className:"flex items-center",children:[r.jsx("span",{className:"text-2xl font-bold text-blue-600",children:"\uD83D\uDCCB"}),r.jsx("span",{className:"ml-2 text-xl font-semibold text-gray-900",children:"JW Attendant Scheduler"})]}),r.jsx("div",{className:"hidden md:ml-8 md:flex md:space-x-4",children:m.map(e=>(0,r.jsxs)(n(),{href:e.href,className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${c.pathname.startsWith(e.href)?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[r.jsx("span",{className:"mr-2",children:e.icon}),e.label]},e.href))})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[l&&(0,r.jsxs)("div",{className:"hidden md:flex items-center bg-blue-50 px-3 py-1 rounded-lg",children:[(0,r.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["\uD83D\uDCC5 ",l.name]}),l.status&&r.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${"current"===l.status?"bg-green-100 text-green-800":"upcoming"===l.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:l.status})]}),d?.user&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("span",{className:"text-sm text-gray-700",children:d.user.name}),r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${"ADMIN"===d.user.role?"bg-red-100 text-red-800":"OVERSEER"===d.user.role?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:d.user.role}),r.jsx("button",{onClick:()=>{(0,a.signOut)({callbackUrl:"/auth/signin"})},className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"Sign Out"})]})]})]})})}),s.length>0&&r.jsx("div",{className:"bg-white border-b border-gray-200",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:r.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:r.jsx("ol",{className:"flex items-center space-x-2",children:s.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center",children:[t>0&&r.jsx("svg",{className:"w-4 h-4 text-gray-400 mx-2",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.href?r.jsx(n(),{href:e.href,className:"text-sm text-blue-600 hover:text-blue-800",children:e.label}):r.jsx("span",{className:"text-sm text-gray-500",children:e.label})]},t))})})})}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t&&r.jsx("div",{className:"mb-8",children:r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t})}),e]})]})}},4171:(e,t,s)=>{"use strict";s.d(t,{Z:()=>M});var r=s(997),a=s(6689),l=s(1163),n=s(1649),i=s(968),d=s.n(i),c=s(1664),o=s.n(c);class m{async getAttendants(e){let t=new URLSearchParams;e.page&&t.append("page",e.page.toString()),e.limit&&t.append("limit",e.limit.toString()),e.search&&t.append("search",e.search),e.congregation&&t.append("congregation",e.congregation),e.formsOfService?.length&&t.append("formsOfService",e.formsOfService.join(",")),void 0!==e.isActive&&t.append("isActive",e.isActive.toString()),void 0!==e.hasUser&&t.append("hasUser",e.hasUser.toString()),e.includeStats&&t.append("includeStats","true");let s=await fetch(`${this.baseUrl}?${t}`);if(!s.ok)throw Error(`Failed to fetch attendants: ${s.statusText}`);return s.json()}async getAttendant(e){let t=await fetch(`${this.baseUrl}/${e}`);if(!t.ok)throw Error(`Failed to fetch attendant: ${t.statusText}`);return t.json()}async createAttendant(e){let t=await fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Failed to create attendant");return t.json()}async updateAttendant(e,t){let s=await fetch(`${this.baseUrl}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw Error((await s.json()).error||"Failed to update attendant");return s.json()}async deleteAttendant(e){let t=await fetch(`${this.baseUrl}/${e}`,{method:"DELETE"});if(!t.ok)throw Error((await t.json()).error||"Failed to delete attendant");return t.json()}async bulkImport(e){let t=await fetch(this.baseUrl,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw console.error("Bulk import error:",e),Error(e.error||`Failed to import attendants (${t.status}: ${t.statusText})`)}return t.json()}async getEventAttendants(e,t){let s=new URLSearchParams({eventId:e});t?.search&&s.append("search",t.search),t?.congregation&&s.append("congregation",t.congregation),t?.formsOfService?.length&&s.append("formsOfService",t.formsOfService.join(",")),t?.isActive!==void 0&&s.append("isActive",t.isActive.toString());let r=await fetch(`${this.baseUrl}?${s}`);if(!r.ok)throw Error(`Failed to fetch event attendants: ${r.statusText}`);return r.json()}async addAttendantToEvent(e,t){let s=await fetch(`/api/event-attendants/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({attendantIds:[t]})});if(!s.ok)throw Error((await s.json()).error||"Failed to add attendant to event");return s.json()}async removeAttendantFromEvent(e,t){let s=await fetch(`/api/event-attendants/${e}/${t}`,{method:"DELETE"});if(!s.ok)throw Error((await s.json()).error||"Failed to remove attendant from event");return s.json()}constructor(){this.baseUrl="/api/attendants"}}let x=new m;function u({value:e,onChange:t,placeholder:s="Search attendants...",disabled:a=!1,className:l=""}){return(0,r.jsxs)("div",{className:`relative ${l}`,children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),r.jsx("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:s,disabled:a,className:`
          block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md
          placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500
          ${a?"bg-gray-100 cursor-not-allowed":"bg-white"}
          sm:text-sm
        `})]})}let h=["Elder","Ministerial Servant","Exemplary","Regular Pioneer","Other Department"];function g({selectedForms:e,onChange:t,disabled:s=!1,className:l="",label:n="Forms of Service",required:i=!1}){let[d,c]=(0,a.useState)(!1),o=s=>{e.includes(s)?t(e.filter(e=>e!==s)):t([...e,s])};return(0,r.jsxs)("div",{className:`relative ${l}`,children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n,i&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("button",{type:"button",onClick:()=>c(!d),disabled:s,className:`
            w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-left
            focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500
            ${s?"bg-gray-100 cursor-not-allowed":"hover:border-gray-400 cursor-pointer"}
            ${0===e.length?"text-gray-500":"text-gray-900"}
          `,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"block truncate",children:0===e.length?"Select forms of service...":1===e.length?e[0]:`${e.length} forms selected`}),r.jsx("svg",{className:`h-5 w-5 text-gray-400 transition-transform ${d?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),d&&r.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg",children:(0,r.jsxs)("div",{className:"py-1",children:[r.jsx("div",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("button",{type:"button",onClick:()=>{t(h)},className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Select All"}),r.jsx("button",{type:"button",onClick:()=>{t([])},className:"text-xs text-gray-600 hover:text-gray-800 font-medium",children:"Clear All"})]})}),r.jsx("div",{className:"max-h-60 overflow-y-auto",children:h.map(t=>(0,r.jsxs)("label",{className:"flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:e.includes(t),onChange:()=>o(t),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("span",{className:"ml-2 text-sm text-gray-900",children:t})]},t))})]})})]}),e.length>0&&r.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:e.map(e=>(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:[e,r.jsx("button",{type:"button",onClick:()=>o(e),className:"ml-1 h-3 w-3 rounded-full hover:bg-blue-200 flex items-center justify-center",children:r.jsx("svg",{className:"h-2 w-2",fill:"currentColor",viewBox:"0 0 8 8",children:r.jsx("path",{d:"M1.41 0l-1.41 1.41.72.72 1.78 1.81-1.78 1.81-.72.72 1.41 1.41.72-.72 1.81-1.78 1.81 1.78.72.72 1.41-1.41-.72-.72-1.78-1.81 1.78-1.81.72-.72-1.41-1.41-.72.72-1.81 1.78-1.81-1.78-.72-.72z"})})})]},e))}),d&&r.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>c(!1)})]})}function p({filters:e,onFiltersChange:t,congregations:s,loading:a=!1}){let l=s=>{t({...e,search:s})},n=s=>{t({...e,congregation:s})},i=s=>{t({...e,isActive:s})},d=s=>{t({...e,hasUser:s})},c=!!(e.search||e.congregation||e.formsOfService?.length||void 0!==e.isActive||void 0!==e.hasUser);return(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"}),c&&r.jsx("button",{onClick:()=>{t({})},disabled:a,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Clear All"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"lg:col-span-1",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),r.jsx(u,{value:e.search||"",onChange:l,placeholder:"Search by name, email, or congregation...",disabled:a})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Congregation"}),(0,r.jsxs)("select",{value:e.congregation||"",onChange:e=>n(e.target.value),disabled:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[r.jsx("option",{value:"",children:"All Congregations"}),s.map(e=>r.jsx("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{value:void 0===e.isActive?"":e.isActive.toString(),onChange:e=>{let t=e.target.value;i(""===t?void 0:"true"===t)},disabled:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"true",children:"Active"}),r.jsx("option",{value:"false",children:"Inactive"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Account"}),(0,r.jsxs)("select",{value:void 0===e.hasUser?"":e.hasUser.toString(),onChange:e=>{let t=e.target.value;d(""===t?void 0:"true"===t)},disabled:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[r.jsx("option",{value:"",children:"All Users"}),r.jsx("option",{value:"true",children:"Has Account"}),r.jsx("option",{value:"false",children:"No Account"})]})]})]}),r.jsx("div",{className:"mt-4",children:r.jsx(g,{selectedForms:e.formsOfService||[],onChange:s=>{t({...e,formsOfService:s})},disabled:a,label:"Filter by Forms of Service"})}),c&&r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.search&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:['Search: "',e.search,'"',r.jsx("button",{onClick:()=>l(""),className:"ml-1 h-3 w-3 rounded-full hover:bg-blue-200 flex items-center justify-center",children:"\xd7"})]}),e.congregation&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-green-100 text-green-800",children:["Congregation: ",e.congregation,r.jsx("button",{onClick:()=>n(""),className:"ml-1 h-3 w-3 rounded-full hover:bg-green-200 flex items-center justify-center",children:"\xd7"})]}),void 0!==e.isActive&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-yellow-100 text-yellow-800",children:["Status: ",e.isActive?"Active":"Inactive",r.jsx("button",{onClick:()=>i(void 0),className:"ml-1 h-3 w-3 rounded-full hover:bg-yellow-200 flex items-center justify-center",children:"\xd7"})]})]})})]})}function f({isActive:e,className:t=""}){return r.jsx("span",{className:`
        inline-flex px-2 py-1 text-xs font-semibold rounded-full
        ${e?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}
        ${t}
      `,children:e?"Active":"Inactive"})}h.map(e=>({value:e,label:e}));let j={Elder:"bg-purple-100 text-purple-800","Ministerial Servant":"bg-blue-100 text-blue-800",Exemplary:"bg-green-100 text-green-800","Regular Pioneer":"bg-yellow-100 text-yellow-800","Other Department":"bg-gray-100 text-gray-800"},v={Elder:"Elder","Ministerial Servant":"MS",Exemplary:"Exemplary","Regular Pioneer":"RP","Other Department":"Other"};function b({form:e,className:t="",size:s="sm"}){return r.jsx("span",{className:`
        inline-flex font-medium rounded-full
        ${j[e]}
        ${"sm"===s?"px-2 py-1 text-xs":"px-3 py-1 text-sm"}
        ${t}
      `,title:e,children:v[e]})}let y={primary:"bg-blue-600 hover:bg-blue-700 text-white border-transparent",secondary:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",danger:"bg-red-600 hover:bg-red-700 text-white border-transparent",success:"bg-green-600 hover:bg-green-700 text-white border-transparent"},N={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};function w({onClick:e,variant:t="primary",size:s="md",disabled:a=!1,loading:l=!1,children:n,className:i="",type:d="button"}){return(0,r.jsxs)("button",{type:d,onClick:e,disabled:a||l,className:`
        inline-flex items-center justify-center
        border rounded-md font-medium
        focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500
        transition-colors duration-200
        ${y[t]}
        ${N[s]}
        ${a||l?"opacity-50 cursor-not-allowed":"cursor-pointer"}
        ${i}
      `,children:[l&&(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]})}function k({attendants:e,loading:t=!1,onEdit:s,onDelete:l,onSelect:n,selectedIds:i=[],onBulkStatusChange:d}){let[c,o]=(0,a.useState)("lastName"),[m,x]=(0,a.useState)("asc"),u=e=>{c===e?x("asc"===m?"desc":"asc"):(o(e),x("asc"))},h=t=>{n&&n(t?e.map(e=>e.id):[])},g=(e,t)=>{n&&(t?n([...i,e]):n(i.filter(t=>t!==e)))},p=[...e].sort((e,t)=>{let s=e[c],r=t[c];if(null==s)return 1;if(null==r)return -1;let a=s<r?-1:s>r?1:0;return"asc"===m?a:-a}),j=({field:e})=>c!==e?r.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):"asc"===m?r.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):r.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),v=e.length>0&&i.length===e.length,y=i.length>0&&i.length<e.length;return t?r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsxs)("div",{className:"px-6 py-12 text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading attendants..."})]})}):0===e.length?r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:r.jsx("div",{className:"px-6 py-12 text-center text-gray-500",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[r.jsx("svg",{className:"w-12 h-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r.jsx("p",{className:"text-lg font-medium",children:"No attendants found"}),r.jsx("p",{className:"text-sm",children:"Try adjusting your filters or create a new attendant"})]})})}):r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[n&&r.jsx("th",{className:"px-3 py-3 text-left w-12",children:r.jsx("input",{type:"checkbox",checked:v,ref:e=>{e&&(e.indeterminate=y)},onChange:e=>h(e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),r.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[15%]",onClick:()=>u("lastName"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"Name"}),r.jsx(j,{field:"lastName"})]})}),r.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[20%]",onClick:()=>u("email"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"Email"}),r.jsx(j,{field:"email"})]})}),r.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[10%]",children:"Phone"}),r.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[12%]",onClick:()=>u("congregation"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"Congregation"}),r.jsx(j,{field:"congregation"})]})}),r.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[15%]",children:"Forms of Service"}),r.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[8%]",onClick:()=>u("isActive"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"Status"}),r.jsx(j,{field:"isActive"})]})}),r.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[10%]",children:"User Account"}),r.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[10%]",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[n&&r.jsx("td",{className:"px-2 py-3",children:r.jsx("input",{type:"checkbox",checked:i.includes(e.id),onChange:t=>g(e.id,t.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),r.jsx("td",{className:"px-2 py-3",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-6 w-6",children:r.jsx("div",{className:"h-6 w-6 rounded-full bg-blue-100 flex items-center justify-center",children:(0,r.jsxs)("span",{className:"text-blue-600 font-medium text-xs",children:[e.firstName[0],e.lastName[0]]})})}),r.jsx("div",{className:"ml-2 truncate",children:(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900 truncate",children:[e.firstName," ",e.lastName]})})]})}),r.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:r.jsx("div",{className:"truncate",title:e.email,children:e.email})}),r.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:r.jsx("div",{className:"truncate",children:e.phone||"N/A"})}),r.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:r.jsx("div",{className:"truncate",title:e.congregation,children:e.congregation})}),r.jsx("td",{className:"px-2 py-3",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.formsOfService?.slice(0,2).map((e,t)=>r.jsx(b,{form:e},t)),e.formsOfService?.length>2&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.formsOfService.length-2]})]})}),r.jsx("td",{className:"px-2 py-3",children:r.jsx(f,{isActive:e.isActive})}),r.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:e.users?r.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Linked"}):r.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:"No Account"})}),r.jsx("td",{className:"px-2 py-3 text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[s&&r.jsx(w,{onClick:()=>s(e),variant:"secondary",size:"sm",children:"Edit"}),l&&r.jsx(w,{onClick:()=>l(e.id),variant:"danger",size:"sm",children:"Delete"})]})})]},e.id))})]})})})}function C({isOpen:e,onClose:t,onSave:s,attendant:l=null,loading:n=!1}){let[i,d]=(0,a.useState)({firstName:"",lastName:"",email:"",phone:"",congregation:"",formsOfService:[],isActive:!0,notes:""}),[c,o]=(0,a.useState)({}),[m,x]=(0,a.useState)(!1),u=()=>{let e={};return i.firstName.trim()||(e.firstName="First name is required"),i.lastName.trim()||(e.lastName="Last name is required"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(e.email="Please enter a valid email address"):e.email="Email is required",i.congregation.trim()||(e.congregation="Congregation is required"),0===i.formsOfService.length&&(e.formsOfService="At least one form of service is required"),o(e),0===Object.keys(e).length},h=async e=>{if(e.preventDefault(),u())try{x(!0),await s(i),t()}catch(e){}finally{x(!1)}},p=(e,t)=>{d(s=>({...s,[e]:t})),c[e]&&o(t=>({...t,[e]:""}))};return e?r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:r.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 xl:w-2/5 shadow-lg rounded-md bg-white",children:r.jsx("form",{onSubmit:h,children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:l?"Edit Attendant":"Create New Attendant"}),r.jsx("button",{type:"button",onClick:t,disabled:m,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.firstName,onChange:e=>p("firstName",e.target.value),disabled:m,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.firstName?"border-red-300":"border-gray-300"}`,placeholder:"Enter first name"}),c.firstName&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.firstName})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.lastName,onChange:e=>p("lastName",e.target.value),disabled:m,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.lastName?"border-red-300":"border-gray-300"}`,placeholder:"Enter last name"}),c.lastName&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.lastName})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"email",value:i.email,onChange:e=>p("email",e.target.value),disabled:m,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.email?"border-red-300":"border-gray-300"}`,placeholder:"Enter email address"}),c.email&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.email})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),r.jsx("input",{type:"tel",value:i.phone,onChange:e=>p("phone",e.target.value),disabled:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Congregation ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.congregation,onChange:e=>p("congregation",e.target.value),disabled:m,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.congregation?"border-red-300":"border-gray-300"}`,placeholder:"Enter congregation name"}),c.congregation&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.congregation})]}),(0,r.jsxs)("div",{children:[r.jsx(g,{selectedForms:i.formsOfService,onChange:e=>p("formsOfService",e),disabled:m,required:!0}),c.formsOfService&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.formsOfService})]}),r.jsx("div",{children:(0,r.jsxs)("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:i.isActive,onChange:e=>p("isActive",e.target.checked),disabled:m,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Active (available for assignments)"})]})}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),r.jsx("textarea",{value:i.notes,onChange:e=>p("notes",e.target.value),disabled:m,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional notes about this attendant"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[r.jsx(w,{onClick:t,variant:"secondary",disabled:m,children:"Cancel"}),r.jsx(w,{onClick:()=>{},type:"submit",variant:"primary",loading:m,disabled:m,children:l?"Update Attendant":"Create Attendant"})]})]})})})}):null}function S({isOpen:e,onClose:t,onImport:s,eventId:l,loading:n=!1}){let[i,d]=(0,a.useState)(""),[c,o]=(0,a.useState)(null),[m,x]=(0,a.useState)([]),[u,g]=(0,a.useState)([]),[p,f]=(0,a.useState)(!1),[j,v]=(0,a.useState)("input"),[b,y]=(0,a.useState)(null),[N,k]=(0,a.useState)("file"),C=`firstName,lastName,email,phone,congregation,formsOfService,isActive,notes
John,Smith,john.smith@example.com,216-555-0123,Central Congregation,"Elder,Exemplary",true,Available for all assignments
Jane,Doe,jane.doe@example.com,216-555-0124,North Congregation,"Ministerial Servant,Regular Pioneer",true,
Mike,Johnson,mike.j@example.com,,South Congregation,"Other Department",false,Currently unavailable`,S=e=>{try{let t=e.trim().split("\n"),s=t[0].split(",").map(e=>e.trim().replace(/"/g,"")),r=["firstName","lastName","email","congregation","formsOfService"].filter(e=>!s.includes(e));if(r.length>0){g([`Missing required columns: ${r.join(", ")}`]);return}let a=[],l=[];for(let e=1;e<t.length;e++){let r=t[e].trim();if(!r)continue;let n=r.split(",").map(e=>e.trim().replace(/"/g,"")),i={};if(s.forEach((e,t)=>{i[e]=n[t]||""}),!i.firstName){l.push(`Row ${e+1}: First name is required`);continue}if(!i.lastName){l.push(`Row ${e+1}: Last name is required`);continue}if(!i.email||!/\S+@\S+\.\S+/.test(i.email)){l.push(`Row ${e+1}: Valid email is required`);continue}if(!i.congregation){l.push(`Row ${e+1}: Congregation is required`);continue}if(!i.formsOfService){l.push(`Row ${e+1}: Forms of service are required`);continue}let d=i.formsOfService.split(",").map(e=>e.trim()).filter(e=>!h.includes(e));if(d.length>0){l.push(`Row ${e+1}: Invalid forms of service: ${d.join(", ")}`);continue}i.isActive="false"!==i.isActive,i.phone=i.phone||"",i.notes=i.notes||"",a.push(i)}if(l.length>0){g(l);return}x(a),g([]),v("preview")}catch(e){g(["Error parsing CSV data. Please check the format."])}},A=async()=>{try{f(!0);let e=await s({attendants:m,eventId:l});y(e),v("results")}catch(e){g([e instanceof Error?e.message:"Import failed"])}finally{f(!1)}},E=()=>{d(""),o(null),x([]),g([]),v("input"),y(null);let e=document.getElementById("csv-file-input");e&&(e.value="")},$=()=>{E(),t()};return e?r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:r.jsx("div",{className:"relative top-10 mx-auto p-5 border w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Bulk Import Attendants"}),r.jsx("button",{type:"button",onClick:$,disabled:p,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:`flex items-center ${"input"===j?"text-blue-600":"text-green-600"}`,children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${"input"===j?"bg-blue-100":"bg-green-100"}`,children:"1"}),r.jsx("span",{className:"ml-2 text-sm font-medium",children:"Input CSV"})]}),r.jsx("div",{className:"flex-1 h-px bg-gray-300 mx-4"}),(0,r.jsxs)("div",{className:`flex items-center ${"preview"===j?"text-blue-600":"results"===j?"text-green-600":"text-gray-400"}`,children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${"preview"===j?"bg-blue-100":"results"===j?"bg-green-100":"bg-gray-100"}`,children:"2"}),r.jsx("span",{className:"ml-2 text-sm font-medium",children:"Preview"})]}),r.jsx("div",{className:"flex-1 h-px bg-gray-300 mx-4"}),(0,r.jsxs)("div",{className:`flex items-center ${"results"===j?"text-blue-600":"text-gray-400"}`,children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${"results"===j?"bg-blue-100":"bg-gray-100"}`,children:"3"}),r.jsx("span",{className:"ml-2 text-sm font-medium",children:"Results"})]})]})}),"input"===j&&(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{className:"ml-3",children:[r.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"CSV Format Requirements"}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-blue-700",children:[r.jsx("p",{children:"Required columns: firstName, lastName, email, congregation, formsOfService"}),r.jsx("p",{children:"Optional columns: phone, isActive, notes"}),(0,r.jsxs)("p",{children:["Forms of Service: ",h.join(", ")]})]})]})]})}),(0,r.jsxs)("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg mb-4",children:[r.jsx("button",{type:"button",onClick:()=>k("file"),className:`flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors ${"file"===N?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"\uD83D\uDCC1 Upload CSV File"}),r.jsx("button",{type:"button",onClick:()=>k("text"),className:`flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors ${"text"===N?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"\uD83D\uDCDD Paste CSV Text"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"file"===N?"CSV File Upload":"CSV Data"}),r.jsx(w,{onClick:()=>{let e=new Blob([C],{type:"text/csv"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="attendant_import_template.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},variant:"secondary",size:"sm",children:"\uD83D\uDCE5 Download Template"})]}),"file"===N?(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center justify-center w-full",children:(0,r.jsxs)("label",{htmlFor:"csv-file-input",className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[r.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:[r.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"CSV files only"})]}),r.jsx("input",{id:"csv-file-input",type:"file",accept:".csv,text/csv",onChange:e=>{let t=e.target.files?.[0];if(t){if("text/csv"!==t.type&&!t.name.endsWith(".csv")){g(["Please select a CSV file"]);return}o(t),g([])}},disabled:p,className:"hidden"})]})}),c&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-md",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 text-green-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("span",{className:"text-sm text-green-800 font-medium",children:c.name}),(0,r.jsxs)("span",{className:"text-xs text-green-600 ml-2",children:["(",(c.size/1024).toFixed(1)," KB)"]})]}),r.jsx("button",{type:"button",onClick:()=>o(null),className:"text-green-600 hover:text-green-800 transition-colors",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):r.jsx("textarea",{value:i,onChange:e=>d(e.target.value),disabled:p,rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm",placeholder:"Paste your CSV data here or download the template to get started..."}),u.length>0&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex",children:[r.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{className:"ml-3",children:[r.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Validation Errors"}),r.jsx("ul",{className:"mt-2 text-sm text-red-700 list-disc list-inside",children:u.map((e,t)=>r.jsx("li",{children:e},t))})]})]})})]}),"preview"===j&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h4",{className:"text-md font-medium text-gray-900",children:["Preview (",m.length," attendants)"]}),r.jsx(w,{onClick:()=>v("input"),variant:"secondary",size:"sm",children:"Back to Edit"})]}),r.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-md",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50 sticky top-0",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Congregation"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Forms of Service"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:[e.firstName," ",e.lastName]}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.email}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.congregation}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.formsOfService}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.isActive?"Active":"Inactive"})]},t))})]})})]}),"results"===j&&b&&(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Import Results"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:b.created||0}),r.jsx("div",{className:"text-sm text-green-800",children:"Created"})]})}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:b.updated||0}),r.jsx("div",{className:"text-sm text-blue-800",children:"Updated"})]})}),r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:b.errors?.length||0}),r.jsx("div",{className:"text-sm text-red-800",children:"Errors"})]})})]}),b.errors&&b.errors.length>0&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[r.jsx("h5",{className:"text-sm font-medium text-red-800 mb-2",children:"Import Errors"}),r.jsx("div",{className:"max-h-40 overflow-y-auto",children:b.errors.map((e,t)=>(0,r.jsxs)("div",{className:"text-sm text-red-700",children:["Row ",e.row," (",e.email,"): ",e.error]},t))})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:["input"===j&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(w,{onClick:$,variant:"secondary",children:"Cancel"}),r.jsx(w,{onClick:"file"===N?()=>{if(!c){g(["Please select a CSV file"]);return}let e=new FileReader;e.onload=e=>{S(e.target?.result)},e.onerror=()=>{g(["Error reading file"])},e.readAsText(c)}:()=>{if(!i.trim()){g(["Please enter CSV data"]);return}S(i)},variant:"primary",disabled:"file"===N?!c:!i.trim(),children:"file"===N?"Process File":"Parse CSV"})]}),"preview"===j&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(w,{onClick:()=>v("input"),variant:"secondary",children:"Back"}),(0,r.jsxs)(w,{onClick:A,variant:"primary",loading:p,disabled:p,children:["Import ",m.length," Attendants"]})]}),"results"===j&&r.jsx(w,{onClick:$,variant:"primary",children:"Done"})]})]})})}):null}function A({stats:e,loading:t=!1,className:s=""}){if(t)return r.jsx("div",{className:`bg-white rounded-lg shadow p-6 ${s}`,children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-6 bg-gray-200 rounded mb-4"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded mb-2"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded"})]},t))})]})});let a=Object.entries(e.byCongregation).sort(([,e],[,t])=>t-e).slice(0,5),l=Object.entries(e.byFormsOfService).filter(([,e])=>e>0).sort(([,e],[,t])=>t-e);return(0,r.jsxs)("div",{className:`bg-white rounded-lg shadow ${s}`,children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Attendant Statistics"})}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Overview"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.total}),r.jsx("div",{className:"text-sm text-blue-800",children:"Total"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.active}),r.jsx("div",{className:"text-sm text-green-800",children:"Active"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.inactive}),r.jsx("div",{className:"text-sm text-red-800",children:"Inactive"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[Math.round(e.active/e.total*100)||0,"%"]}),r.jsx("div",{className:"text-sm text-purple-800",children:"Active Rate"})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"User Accounts"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-xl font-bold text-green-600",children:e.withUsers}),r.jsx("div",{className:"text-sm text-green-800",children:"With Accounts"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"text-xl font-bold text-gray-600",children:e.withoutUsers}),r.jsx("div",{className:"text-sm text-gray-800",children:"No Account"})]})]})]}),l.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Forms of Service"}),r.jsx("div",{className:"space-y-2",children:l.map(([t,s])=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(b,{form:t}),r.jsx("span",{className:"text-sm text-gray-700",children:t})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-sm font-medium text-gray-900",children:s}),r.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${s/e.total*100}%`}})})]})]},t))})]}),a.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:["Top Congregations",Object.keys(e.byCongregation).length>5&&r.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"(showing top 5)"})]}),r.jsx("div",{className:"space-y-2",children:a.map(([t,s])=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[r.jsx("span",{className:"text-sm text-gray-700 truncate flex-1 mr-2",children:t}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-sm font-medium text-gray-900",children:s}),r.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${s/e.total*100}%`}})})]})]},t))}),Object.keys(e.byCongregation).length>5&&r.jsx("div",{className:"text-center mt-2",children:(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["+",Object.keys(e.byCongregation).length-5," more congregations"]})})]}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Quick Insights"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,r.jsxs)("span",{children:[Object.keys(e.byCongregation).length," congregations represented"]})]}),e.withUsers>0&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,r.jsxs)("span",{children:[Math.round(e.withUsers/e.total*100),"% have user accounts"]})]}),l.length>0&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("svg",{className:"w-4 h-4 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),(0,r.jsxs)("span",{children:["Most common: ",l[0][0]," (",l[0][1]," attendants)"]})]})]})]})]})]})}let E=[{value:10,label:"10"},{value:25,label:"25"},{value:50,label:"50"},{value:100,label:"100"},{value:-1,label:"All"}];function $({currentPage:e,totalPages:t,totalItems:s,pageSize:a,onPageChange:l,onPageSizeChange:n,loading:i=!1}){let d=0===s?0:(e-1)*a+1,c=-1===a?s:Math.min(e*a,s),o=t=>{n(t),e>1&&l(1)};return 0===s?null:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 py-4",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing ",d," to ",c," of ",s," results"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("label",{htmlFor:"pageSize",className:"text-sm text-gray-700",children:"Show:"}),r.jsx("select",{id:"pageSize",value:a,onChange:e=>o(Number(e.target.value)),disabled:i,className:"border border-gray-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:E.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))}),r.jsx("span",{className:"text-sm text-gray-700",children:"per page"})]})]}),-1!==a&&t>1&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(w,{onClick:()=>l(e-1),disabled:e<=1||i,variant:"secondary",size:"sm",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]}),r.jsx("div",{className:"flex items-center gap-1",children:(()=>{let s=[];if(t<=5)for(let e=1;e<=t;e++)s.push(e);else{let r=Math.max(1,e-2),a=Math.min(t,r+5-1);for(let e=r;e<=a;e++)s.push(e)}return s})().map(t=>r.jsx("button",{onClick:()=>l(t),disabled:i,className:`px-3 py-1 text-sm rounded-md transition-colors ${t===e?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"} ${i?"opacity-50 cursor-not-allowed":""}`,children:t},t))}),(0,r.jsxs)(w,{onClick:()=>l(e+1),disabled:e>=t||i,variant:"secondary",size:"sm",children:["Next",r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})}function M({eventId:e,eventName:t}){(0,l.useRouter)();let{data:s}=(0,n.useSession)(),[i,c]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[f,j]=(0,a.useState)([]),[v,b]=(0,a.useState)([]),{attendants:y,loading:N,error:E,pagination:M,stats:L,filters:O,setFilters:D,setPage:F,setPageSize:z,refresh:R,createAttendant:U,updateAttendant:B,deleteAttendant:P}=function(e={}){let{eventId:t,initialFilters:s={},pageSize:r=10,includeStats:l=!1}=e,[n,i]=(0,a.useState)([]),[d,c]=(0,a.useState)(!0),[o,m]=(0,a.useState)(null),[u,h]=(0,a.useState)(),[g,p]=(0,a.useState)(s),[f,j]=(0,a.useState)({page:1,limit:r,total:0,pages:0}),v=(0,a.useCallback)(async()=>{try{c(!0),m(null);let e=t?await x.getEventAttendants(t,g):await x.getAttendants({...g,page:f.page,limit:f.limit,includeStats:l});e.success?(i(e.data.attendants),j(e.data.pagination),e.data.stats&&h(e.data.stats)):m(e.error||"Failed to fetch attendants")}catch(e){m(e instanceof Error?e.message:"An error occurred")}finally{c(!1)}},[t,g,f.page,f.limit,l]),b=(0,a.useCallback)(e=>{j(t=>({...t,page:e}))},[]),y=(0,a.useCallback)(e=>{j(t=>({...t,limit:-1===e?999999:e,page:1}))},[]),N=(0,a.useCallback)(async()=>{await v()},[v]),w=(0,a.useCallback)(async e=>{try{m(null);let t=await x.createAttendant(e);if(t.success)await N();else throw Error(t.error||"Failed to create attendant")}catch(t){let e=t instanceof Error?t.message:"Failed to create attendant";throw m(e),Error(e)}},[N]),k=(0,a.useCallback)(async(e,t)=>{try{m(null);let s=await x.updateAttendant(e,t);if(s.success)await N();else throw Error(s.error||"Failed to update attendant")}catch(t){let e=t instanceof Error?t.message:"Failed to update attendant";throw m(e),Error(e)}},[N]),C=(0,a.useCallback)(async e=>{try{if(m(null),(await x.deleteAttendant(e)).success)await N();else throw Error("Failed to delete attendant")}catch(t){let e=t instanceof Error?t.message:"Failed to delete attendant";throw m(e),Error(e)}},[N]);return{attendants:n,loading:d,error:o,pagination:f,stats:u,filters:g,setFilters:p,setPage:b,setPageSize:y,refresh:N,createAttendant:w,updateAttendant:k,deleteAttendant:C}}({eventId:e,pageSize:25,includeStats:!0}),I=async e=>{h?await B(h.id,e):await U(e),g(null)},T=async e=>{try{let t=await x.bulkImport(e);return await R(),t.data}catch(e){throw console.error("Bulk import error:",e),e}},W=async(e,t)=>{try{let s=e.map(e=>x.updateAttendant(e,{isActive:t}));await Promise.all(s),await R(),j([])}catch(e){throw console.error("Bulk status change error:",e),e}},V=async e=>{confirm("Are you sure you want to delete this attendant? This action cannot be undone.")&&(await P(e),j(t=>t.filter(t=>t!==e)))},q=async()=>{if(0!==f.length&&confirm(`Are you sure you want to delete ${f.length} attendant(s)? This action cannot be undone.`))try{await Promise.all(f.map(e=>P(e))),j([])}catch(e){console.error("Error deleting attendants:",e)}},J=e?`${t||"Event"} - Attendants`:"Attendant Management";return(0,r.jsxs)(r.Fragment,{children:[r.jsx(d(),{children:(0,r.jsxs)("title",{children:[J," | JW Attendant Scheduler"]})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[e&&(0,r.jsxs)("nav",{className:"flex items-center space-x-2 text-sm text-gray-500 mb-4",children:[r.jsx(o(),{href:"/events",className:"hover:text-gray-700",children:"Events"}),r.jsx("span",{children:"â€º"}),r.jsx(o(),{href:`/events/${e}`,className:"hover:text-gray-700",children:t||"Event"}),r.jsx("span",{children:"â€º"}),r.jsx("span",{className:"text-gray-900",children:"Attendants"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e?"Event Attendants":"Attendant Management"}),r.jsx("p",{className:"text-gray-600 mt-2",children:e?`Manage attendants for ${t}`:"Manage all attendants across the organization"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[e&&r.jsx(o(),{href:`/events/${e}`,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",children:"â† Back to Event"}),r.jsx(w,{onClick:()=>u(!0),variant:"secondary",children:"\uD83D\uDCE5 Bulk Import"}),r.jsx(w,{onClick:()=>{g(null),c(!0)},variant:"primary",children:"+ Add Attendant"})]})]})]}),E&&r.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex",children:[r.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{className:"ml-3",children:[r.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Error"}),r.jsx("p",{className:"text-sm text-red-700 mt-1",children:E})]})]})}),L&&!N&&r.jsx("div",{className:"mb-6",children:r.jsx(A,{stats:L})}),r.jsx("div",{className:"mb-6",children:r.jsx(p,{filters:O,onFiltersChange:D,congregations:v,loading:N})}),f.length>0&&r.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("span",{className:"ml-2 text-sm font-medium text-blue-800",children:[f.length," attendant(s) selected"]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[r.jsx(w,{onClick:()=>j([]),variant:"secondary",size:"sm",children:"Clear Selection"}),r.jsx(w,{onClick:()=>W(f,!0),variant:"primary",size:"sm",children:"Activate Selected"}),r.jsx(w,{onClick:()=>W(f,!1),variant:"secondary",size:"sm",children:"Deactivate Selected"}),r.jsx(w,{onClick:q,variant:"danger",size:"sm",children:"Delete Selected"})]})]})}),r.jsx("div",{className:"mb-6",children:r.jsx(k,{attendants:y,loading:N,onEdit:e=>{g(e),c(!0)},onDelete:V,onSelect:j,selectedIds:f,onBulkStatusChange:W})}),r.jsx($,{currentPage:M.page,totalPages:M.pages,totalItems:M.total,pageSize:999999===M.limit?-1:M.limit,onPageChange:F,onPageSizeChange:z,loading:N})]}),r.jsx(C,{isOpen:i,onClose:()=>{c(!1),g(null)},onSave:I,attendant:h}),r.jsx(S,{isOpen:m,onClose:()=>u(!1),onImport:T,eventId:e})]})}},6814:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(997),a=s(1649);function l({Component:e,pageProps:{session:t,...s}}){return r.jsx(a.SessionProvider,{session:t,children:r.jsx(e,{...s})})}s(6764)},6847:(e,t,s)=>{"use strict";s.d(t,{L:()=>u});var r=s(3227),a=s.n(r),l=s(7449),n=s.n(l),i=s(7652),d=s(8432),c=s.n(d),o=s(2048),m=s.n(o);let x=e=>{let t=new Date().toISOString(),s=`[${t}] ${e}
`;try{m().appendFileSync("/tmp/nextauth-debug.log",s)}catch(e){}},u={providers:[n()({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){try{if(x(`Starting authorization for: ${e?.email}`),!e?.email||!e?.password)return x("Missing credentials"),null;x("Looking up user in database...");let t=await i.prisma.users.findUnique({where:{email:e.email}});if(!t)return x(`User not found: ${e.email}`),null;if(!t.passwordHash)return x("User has no password hash"),null;x("Comparing password...");let s=await c().compare(e.password,t.passwordHash);if(x(`Password valid: ${s}`),!s)return x(`Invalid password for: ${e.email}`),null;return x(`Authentication successful for: ${t.email}`),{id:t.id,email:t.email,name:`${t.firstName} ${t.lastName}`,image:t.image||null,role:t.role}}catch(e){return x(`Error during authorization: ${e}`),null}}})],session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role,e.image=t.image),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.sub,e.user.role=t.role),e)},pages:{signIn:"/auth/signin"}};a()(u)},7652:(e,t,s)=>{"use strict";s.r(t),s.d(t,{prisma:()=>a});var r=s(3524);let a=globalThis.prisma??new r.PrismaClient},6764:()=>{}};