(()=>{var e={};e.id=7199,e.ids=[7199,2888,660],e.modules={2850:(e,t,s)=>{"use strict";s.r(t),s.d(t,{config:()=>_,default:()=>V,getServerSideProps:()=>X,getStaticPaths:()=>G,getStaticProps:()=>W,reportWebVitals:()=>J,routeModule:()=>ee,unstable_getServerProps:()=>Q,unstable_getServerSideProps:()=>Y,unstable_getStaticParams:()=>K,unstable_getStaticPaths:()=>Z,unstable_getStaticProps:()=>H});var r={};s.r(r),s.d(r,{default:()=>q,getServerSideProps:()=>T});var a=s(7093),l=s(5244),n=s(1323),i=s(2899),d=s.n(i),c=s(6814),o=s(997),m=s(3227),x=s(5175),u=s(6689),h=s.n(u),g=s(1163),p=s(1649),f=s(968),v=s.n(f),j=s(1664),b=s.n(j);class N{getBaseUrl(e){return`/api/events/${e}/attendants`}async getEventAttendants(e,t){let s=new URLSearchParams;t?.page&&s.append("page",t.page.toString()),t?.limit&&s.append("limit",t.limit.toString()),t?.search&&s.append("search",t.search),t?.congregation&&s.append("congregation",t.congregation),t?.formsOfService?.length&&s.append("formsOfService",t.formsOfService.join(",")),t?.isActive!==void 0&&s.append("isActive",t.isActive.toString()),t?.hasUser!==void 0&&s.append("hasUser",t.hasUser.toString()),t?.includeStats&&s.append("includeStats","true");let r=await fetch(`${this.getBaseUrl(e)}?${s}`);if(!r.ok)throw Error(`Failed to fetch event attendants: ${r.statusText}`);return r.json()}async getEventAttendant(e,t){let s=await fetch(`${this.getBaseUrl(e)}/${t}`);if(!s.ok)throw Error(`Failed to fetch event attendant: ${s.statusText}`);return s.json()}async createEventAttendant(e,t){let s=await fetch(this.getBaseUrl(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw Error((await s.json()).error||`Failed to create event attendant (${s.status}: ${s.statusText})`);return s.json()}async updateEventAttendant(e,t,s){let r=await fetch(`${this.getBaseUrl(e)}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok)throw Error((await r.json()).error||`Failed to update event attendant (${r.status}: ${r.statusText})`);return r.json()}async deleteEventAttendant(e,t){let s=await fetch(`${this.getBaseUrl(e)}/${t}`,{method:"DELETE"});if(!s.ok)throw Error((await s.json()).error||`Failed to delete event attendant (${s.status}: ${s.statusText})`);return s.json()}async bulkImportEventAttendants(e,t){let s=await fetch(this.getBaseUrl(e),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!s.ok){let e=await s.json();throw console.error("Bulk import error:",e),Error(e.error||`Failed to import event attendants (${s.status}: ${s.statusText})`)}return s.json()}async bulkUpdateEventAttendantStatus(e,t,s){return{success:!0}}async bulkDeleteEventAttendants(e,t){let s=t.map(t=>this.deleteEventAttendant(e,t));try{return await Promise.all(s),{success:!0}}catch(e){throw Error(`Failed to bulk delete attendants: ${e instanceof Error?e.message:"Unknown error"}`)}}}let y=new N;function w({value:e,onChange:t,placeholder:s="Search attendants...",disabled:r=!1,className:a=""}){return(0,o.jsxs)("div",{className:`relative ${a}`,children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),o.jsx("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:s,disabled:r,className:`
          block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md
          placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500
          ${r?"bg-gray-100 cursor-not-allowed":"bg-white"}
          sm:text-sm
        `})]})}let k=["Elder","Ministerial Servant","Exemplary","Regular Pioneer","Other Department"];function S({selectedForms:e,onChange:t,disabled:s=!1,className:r="",label:a="Forms of Service",required:l=!1}){let[n,i]=(0,u.useState)(!1),d=s=>{e.includes(s)?t(e.filter(e=>e!==s)):t([...e,s])};return(0,o.jsxs)("div",{className:`relative ${r}`,children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a,l&&o.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,o.jsxs)("div",{className:"relative",children:[o.jsx("button",{type:"button",onClick:()=>i(!n),disabled:s,className:`
            w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-left
            focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500
            ${s?"bg-gray-100 cursor-not-allowed":"hover:border-gray-400 cursor-pointer"}
            ${0===e.length?"text-gray-500":"text-gray-900"}
          `,children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"block truncate",children:0===e.length?"Select forms of service...":1===e.length?e[0]:`${e.length} forms selected`}),o.jsx("svg",{className:`h-5 w-5 text-gray-400 transition-transform ${n?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),n&&o.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg",children:(0,o.jsxs)("div",{className:"py-1",children:[o.jsx("div",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:(0,o.jsxs)("div",{className:"flex justify-between",children:[o.jsx("button",{type:"button",onClick:()=>{t(k)},className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Select All"}),o.jsx("button",{type:"button",onClick:()=>{t([])},className:"text-xs text-gray-600 hover:text-gray-800 font-medium",children:"Clear All"})]})}),o.jsx("div",{className:"max-h-60 overflow-y-auto",children:k.map(t=>(0,o.jsxs)("label",{className:"flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:e.includes(t),onChange:()=>d(t),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsx("span",{className:"ml-2 text-sm text-gray-900",children:t})]},t))})]})})]}),e.length>0&&o.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:e.map(e=>(0,o.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:[e,o.jsx("button",{type:"button",onClick:()=>d(e),className:"ml-1 h-3 w-3 rounded-full hover:bg-blue-200 flex items-center justify-center",children:o.jsx("svg",{className:"h-2 w-2",fill:"currentColor",viewBox:"0 0 8 8",children:o.jsx("path",{d:"M1.41 0l-1.41 1.41.72.72 1.78 1.81-1.78 1.81-.72.72 1.41 1.41.72-.72 1.81-1.78 1.81 1.78.72.72 1.41-1.41-.72-.72-1.78-1.81 1.78-1.81.72-.72-1.41-1.41-.72.72-1.81 1.78-1.81-1.78-.72-.72z"})})})]},e))}),n&&o.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>i(!1)})]})}function C({filters:e,onFiltersChange:t,congregations:s,loading:r=!1}){let a=s=>{t({...e,search:s})},l=s=>{t({...e,congregation:s})},n=s=>{t({...e,isActive:s})},i=s=>{t({...e,hasUser:s})},d=!!(e.search||e.congregation||e.formsOfService?.length||void 0!==e.isActive||void 0!==e.hasUser);return(0,o.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"}),d&&o.jsx("button",{onClick:()=>{t({})},disabled:r,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Clear All"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,o.jsxs)("div",{className:"lg:col-span-1",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),o.jsx(w,{value:e.search||"",onChange:a,placeholder:"Search by name, email, or congregation...",disabled:r})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Congregation"}),(0,o.jsxs)("select",{value:e.congregation||"",onChange:e=>l(e.target.value),disabled:r,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[o.jsx("option",{value:"",children:"All Congregations"}),s.map(e=>o.jsx("option",{value:e,children:e},e))]})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,o.jsxs)("select",{value:void 0===e.isActive?"":e.isActive.toString(),onChange:e=>{let t=e.target.value;n(""===t?void 0:"true"===t)},disabled:r,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[o.jsx("option",{value:"",children:"All Status"}),o.jsx("option",{value:"true",children:"Active"}),o.jsx("option",{value:"false",children:"Inactive"})]})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Account"}),(0,o.jsxs)("select",{value:void 0===e.hasUser?"":e.hasUser.toString(),onChange:e=>{let t=e.target.value;i(""===t?void 0:"true"===t)},disabled:r,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[o.jsx("option",{value:"",children:"All Users"}),o.jsx("option",{value:"true",children:"Has Account"}),o.jsx("option",{value:"false",children:"No Account"})]})]})]}),o.jsx("div",{className:"mt-4",children:o.jsx(S,{selectedForms:e.formsOfService||[],onChange:s=>{t({...e,formsOfService:s})},disabled:r,label:"Filter by Forms of Service"})}),d&&o.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,o.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.search&&(0,o.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:['Search: "',e.search,'"',o.jsx("button",{onClick:()=>a(""),className:"ml-1 h-3 w-3 rounded-full hover:bg-blue-200 flex items-center justify-center",children:"\xd7"})]}),e.congregation&&(0,o.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-green-100 text-green-800",children:["Congregation: ",e.congregation,o.jsx("button",{onClick:()=>l(""),className:"ml-1 h-3 w-3 rounded-full hover:bg-green-200 flex items-center justify-center",children:"\xd7"})]}),void 0!==e.isActive&&(0,o.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-yellow-100 text-yellow-800",children:["Status: ",e.isActive?"Active":"Inactive",o.jsx("button",{onClick:()=>n(void 0),className:"ml-1 h-3 w-3 rounded-full hover:bg-yellow-200 flex items-center justify-center",children:"\xd7"})]})]})})]})}function A({isActive:e,className:t=""}){return o.jsx("span",{className:`
        inline-flex px-2 py-1 text-xs font-semibold rounded-full
        ${e?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}
        ${t}
      `,children:e?"Active":"Inactive"})}k.map(e=>({value:e,label:e}));let E={Elder:"bg-purple-100 text-purple-800","Ministerial Servant":"bg-blue-100 text-blue-800",Exemplary:"bg-green-100 text-green-800","Regular Pioneer":"bg-yellow-100 text-yellow-800","Other Department":"bg-gray-100 text-gray-800"},D={Elder:"Elder","Ministerial Servant":"MS",Exemplary:"Exemplary","Regular Pioneer":"RP","Other Department":"Other"};function P({form:e,className:t="",size:s="sm"}){return o.jsx("span",{className:`
        inline-flex font-medium rounded-full
        ${E[e]}
        ${"sm"===s?"px-2 py-1 text-xs":"px-3 py-1 text-sm"}
        ${t}
      `,title:e,children:D[e]})}let $={primary:"bg-blue-600 hover:bg-blue-700 text-white border-transparent",secondary:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",danger:"bg-red-600 hover:bg-red-700 text-white border-transparent",success:"bg-green-600 hover:bg-green-700 text-white border-transparent"},R={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};function I({onClick:e,variant:t="primary",size:s="md",disabled:r=!1,loading:a=!1,children:l,className:n="",type:i="button"}){return(0,o.jsxs)("button",{type:i,onClick:t=>{"button"===i&&t.preventDefault(),e(t)},disabled:r||a,className:`
        inline-flex items-center justify-center
        border rounded-md font-medium
        focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500
        transition-colors duration-200
        ${$[t]}
        ${R[s]}
        ${r||a?"opacity-50 cursor-not-allowed":"cursor-pointer"}
        ${n}
      `,children:[a&&(0,o.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l]})}function U({attendants:e,loading:t=!1,onEdit:s,onDelete:r,onSelect:a,selectedIds:l=[],onBulkStatusChange:n}){let[i,d]=(0,u.useState)("lastName"),[c,m]=(0,u.useState)("asc"),x=e=>{i===e?m("asc"===c?"desc":"asc"):(d(e),m("asc"))},h=t=>{a&&a(t?e.map(e=>e.id):[])},g=(e,t)=>{a&&(t?a([...l,e]):a(l.filter(t=>t!==e)))},p=[...e].sort((e,t)=>{let s=e[i],r=t[i];if(null==s)return 1;if(null==r)return -1;let a=s<r?-1:s>r?1:0;return"asc"===c?a:-a}),f=({field:e})=>i!==e?o.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):"asc"===c?o.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):o.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),v=e.length>0&&l.length===e.length,j=l.length>0&&l.length<e.length;return t?o.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,o.jsxs)("div",{className:"px-6 py-12 text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading attendants..."})]})}):0===e.length?o.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:o.jsx("div",{className:"px-6 py-12 text-center text-gray-500",children:(0,o.jsxs)("div",{className:"flex flex-col items-center",children:[o.jsx("svg",{className:"w-12 h-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),o.jsx("p",{className:"text-lg font-medium",children:"No attendants found"}),o.jsx("p",{className:"text-sm",children:"Try adjusting your filters or create a new attendant"})]})})}):o.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[a&&o.jsx("th",{className:"px-3 py-3 text-left w-12",children:o.jsx("input",{type:"checkbox",checked:v,ref:e=>{e&&(e.indeterminate=j)},onChange:e=>h(e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),o.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[15%]",onClick:()=>x("lastName"),children:(0,o.jsxs)("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Name"}),o.jsx(f,{field:"lastName"})]})}),o.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[20%]",onClick:()=>x("email"),children:(0,o.jsxs)("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Email"}),o.jsx(f,{field:"email"})]})}),o.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[10%]",children:"Phone"}),o.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[12%]",onClick:()=>x("congregation"),children:(0,o.jsxs)("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Congregation"}),o.jsx(f,{field:"congregation"})]})}),o.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[15%]",children:"Forms of Service"}),o.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[8%]",onClick:()=>x("isActive"),children:(0,o.jsxs)("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Status"}),o.jsx(f,{field:"isActive"})]})}),o.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[10%]",children:"User Account"}),o.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[10%]",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(e=>(0,o.jsxs)("tr",{className:"hover:bg-gray-50",children:[a&&o.jsx("td",{className:"px-2 py-3",children:o.jsx("input",{type:"checkbox",checked:l.includes(e.id),onChange:t=>g(e.id,t.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),o.jsx("td",{className:"px-2 py-3",children:(0,o.jsxs)("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 h-6 w-6",children:o.jsx("div",{className:"h-6 w-6 rounded-full bg-blue-100 flex items-center justify-center",children:(0,o.jsxs)("span",{className:"text-blue-600 font-medium text-xs",children:[e.firstName[0],e.lastName[0]]})})}),o.jsx("div",{className:"ml-2 truncate",children:(0,o.jsxs)("div",{className:"text-sm font-medium text-gray-900 truncate",children:[e.firstName," ",e.lastName]})})]})}),o.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:o.jsx("div",{className:"truncate",title:e.email,children:e.email})}),o.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:o.jsx("div",{className:"truncate",children:e.phone||"N/A"})}),o.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:o.jsx("div",{className:"truncate",title:e.congregation,children:e.congregation})}),o.jsx("td",{className:"px-2 py-3",children:(0,o.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.formsOfService?.slice(0,2).map((e,t)=>o.jsx(P,{form:e},t)),e.formsOfService?.length>2&&(0,o.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.formsOfService.length-2]})]})}),o.jsx("td",{className:"px-2 py-3",children:o.jsx(A,{isActive:e.isActive})}),o.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:e.users?o.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Linked"}):o.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:"No Account"})}),o.jsx("td",{className:"px-2 py-3 text-sm font-medium",children:(0,o.jsxs)("div",{className:"flex flex-col gap-1",children:[s&&o.jsx(I,{onClick:()=>s(e),variant:"secondary",size:"sm",children:"Edit"}),r&&o.jsx(I,{onClick:()=>r(e.id),variant:"danger",size:"sm",children:"Delete"})]})})]},e.id))})]})})})}function L({isOpen:e,onClose:t,onSave:s,attendant:r=null,loading:a=!1}){let[l,n]=(0,u.useState)({firstName:"",lastName:"",email:"",phone:"",congregation:"",formsOfService:[],isActive:!0,notes:""}),[i,d]=(0,u.useState)({}),[c,m]=(0,u.useState)(!1),x=()=>{let e={};return l.firstName.trim()||(e.firstName="First name is required"),l.lastName.trim()||(e.lastName="Last name is required"),l.email.trim()?/\S+@\S+\.\S+/.test(l.email)||(e.email="Please enter a valid email address"):e.email="Email is required",l.congregation.trim()||(e.congregation="Congregation is required"),0===l.formsOfService.length&&(e.formsOfService="At least one form of service is required"),d(e),0===Object.keys(e).length},h=async e=>{if(e.preventDefault(),x())try{m(!0),await s(l),t()}catch(e){}finally{m(!1)}},g=(e,t)=>{n(s=>({...s,[e]:t})),i[e]&&d(t=>({...t,[e]:""}))};return e?o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 xl:w-2/5 shadow-lg rounded-md bg-white",children:o.jsx("form",{onSubmit:h,children:(0,o.jsxs)("div",{className:"mt-3",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:r?"Edit Attendant":"Create New Attendant"}),o.jsx("button",{type:"button",onClick:t,disabled:c,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:l.firstName,onChange:e=>g("firstName",e.target.value),disabled:c,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.firstName?"border-red-300":"border-gray-300"}`,placeholder:"Enter first name"}),i.firstName&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.firstName})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:l.lastName,onChange:e=>g("lastName",e.target.value),disabled:c,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.lastName?"border-red-300":"border-gray-300"}`,placeholder:"Enter last name"}),i.lastName&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.lastName})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"email",value:l.email,onChange:e=>g("email",e.target.value),disabled:c,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.email?"border-red-300":"border-gray-300"}`,placeholder:"Enter email address"}),i.email&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.email})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),o.jsx("input",{type:"tel",value:l.phone,onChange:e=>g("phone",e.target.value),disabled:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Congregation ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:l.congregation,onChange:e=>g("congregation",e.target.value),disabled:c,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.congregation?"border-red-300":"border-gray-300"}`,placeholder:"Enter congregation name"}),i.congregation&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.congregation})]}),(0,o.jsxs)("div",{children:[o.jsx(S,{selectedForms:l.formsOfService,onChange:e=>g("formsOfService",e),disabled:c,required:!0}),i.formsOfService&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.formsOfService})]}),o.jsx("div",{children:(0,o.jsxs)("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:l.isActive,onChange:e=>g("isActive",e.target.checked),disabled:c,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Active (available for assignments)"})]})}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),o.jsx("textarea",{value:l.notes,onChange:e=>g("notes",e.target.value),disabled:c,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional notes about this attendant"})]})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[o.jsx(I,{onClick:t,variant:"secondary",disabled:c,children:"Cancel"}),o.jsx(I,{onClick:()=>{},type:"submit",variant:"primary",loading:c,disabled:c,children:r?"Update Attendant":"Create Attendant"})]})]})})})}):null}function M({isOpen:e,onClose:t,onImport:s,eventId:r,loading:a=!1}){let[l,n]=(0,u.useState)(""),[i,d]=(0,u.useState)(null),[c,m]=(0,u.useState)([]),[x,h]=(0,u.useState)([]),[g,p]=(0,u.useState)(!1),[f,v]=(0,u.useState)("input"),[j,b]=(0,u.useState)(null),[N,y]=(0,u.useState)("file"),w=`firstName,lastName,email,phone,congregation,formsOfService,isActive,notes
John,Smith,john.smith@example.com,216-555-0123,Central Congregation,"Elder,Exemplary",true,Available for all assignments
Jane,Doe,jane.doe@example.com,216-555-0124,North Congregation,"Ministerial Servant,Regular Pioneer",true,
Mike,Johnson,mike.j@example.com,,South Congregation,"Other Department",false,Currently unavailable`,S=e=>{try{let t=e.trim().split("\n"),s=t[0].split(",").map(e=>e.trim().replace(/"/g,"")),r=["firstName","lastName","email","congregation","formsOfService"].filter(e=>!s.includes(e));if(r.length>0){h([`Missing required columns: ${r.join(", ")}`]);return}let a=[],l=[];for(let e=1;e<t.length;e++){let r=t[e].trim();if(!r)continue;let n=r.split(",").map(e=>e.trim().replace(/"/g,"")),i={};if(s.forEach((e,t)=>{i[e]=n[t]||""}),!i.firstName){l.push(`Row ${e+1}: First name is required`);continue}if(!i.lastName){l.push(`Row ${e+1}: Last name is required`);continue}if(!i.email||!/\S+@\S+\.\S+/.test(i.email)){l.push(`Row ${e+1}: Valid email is required`);continue}if(!i.congregation){l.push(`Row ${e+1}: Congregation is required`);continue}if(!i.formsOfService){l.push(`Row ${e+1}: Forms of service are required`);continue}let d=i.formsOfService.split(",").map(e=>e.trim()).filter(e=>!k.includes(e));if(d.length>0){l.push(`Row ${e+1}: Invalid forms of service: ${d.join(", ")}`);continue}i.isActive="false"!==i.isActive,i.phone=i.phone||"",i.notes=i.notes||"",a.push(i)}if(l.length>0){h(l);return}m(a),h([]),v("preview")}catch(e){h(["Error parsing CSV data. Please check the format."])}},C=async()=>{try{p(!0);let e=await s({attendants:c,eventId:r});b(e),v("results")}catch(e){h([e instanceof Error?e.message:"Import failed"])}finally{p(!1)}},A=()=>{n(""),d(null),m([]),h([]),v("input"),b(null);let e=document.getElementById("csv-file-input");e&&(e.value="")},E=()=>{A(),t()};return e?o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-10 mx-auto p-5 border w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto",children:(0,o.jsxs)("div",{className:"mt-3",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Bulk Import Attendants"}),o.jsx("button",{type:"button",onClick:E,disabled:g,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{className:"mb-6",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsxs)("div",{className:`flex items-center ${"input"===f?"text-blue-600":"text-green-600"}`,children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${"input"===f?"bg-blue-100":"bg-green-100"}`,children:"1"}),o.jsx("span",{className:"ml-2 text-sm font-medium",children:"Input CSV"})]}),o.jsx("div",{className:"flex-1 h-px bg-gray-300 mx-4"}),(0,o.jsxs)("div",{className:`flex items-center ${"preview"===f?"text-blue-600":"results"===f?"text-green-600":"text-gray-400"}`,children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${"preview"===f?"bg-blue-100":"results"===f?"bg-green-100":"bg-gray-100"}`,children:"2"}),o.jsx("span",{className:"ml-2 text-sm font-medium",children:"Preview"})]}),o.jsx("div",{className:"flex-1 h-px bg-gray-300 mx-4"}),(0,o.jsxs)("div",{className:`flex items-center ${"results"===f?"text-blue-600":"text-gray-400"}`,children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${"results"===f?"bg-blue-100":"bg-gray-100"}`,children:"3"}),o.jsx("span",{className:"ml-2 text-sm font-medium",children:"Results"})]})]})}),"input"===f&&(0,o.jsxs)("div",{className:"space-y-4",children:[o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,o.jsxs)("div",{className:"flex items-start",children:[o.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,o.jsxs)("div",{className:"ml-3",children:[o.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"CSV Format Requirements"}),(0,o.jsxs)("div",{className:"mt-2 text-sm text-blue-700",children:[o.jsx("p",{children:"Required columns: firstName, lastName, email, congregation, formsOfService"}),o.jsx("p",{children:"Optional columns: phone, isActive, notes"}),(0,o.jsxs)("p",{children:["Forms of Service: ",k.join(", ")]})]})]})]})}),(0,o.jsxs)("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg mb-4",children:[o.jsx("button",{type:"button",onClick:()=>y("file"),className:`flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors ${"file"===N?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"\uD83D\uDCC1 Upload CSV File"}),o.jsx("button",{type:"button",onClick:()=>y("text"),className:`flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors ${"text"===N?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"\uD83D\uDCDD Paste CSV Text"})]}),(0,o.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"file"===N?"CSV File Upload":"CSV Data"}),o.jsx(I,{onClick:()=>{let e=new Blob([w],{type:"text/csv"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="attendant_import_template.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},variant:"secondary",size:"sm",children:"\uD83D\uDCE5 Download Template"})]}),"file"===N?(0,o.jsxs)("div",{className:"space-y-4",children:[o.jsx("div",{className:"flex items-center justify-center w-full",children:(0,o.jsxs)("label",{htmlFor:"csv-file-input",className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[o.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,o.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:[o.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),o.jsx("p",{className:"text-xs text-gray-500",children:"CSV files only"})]}),o.jsx("input",{id:"csv-file-input",type:"file",accept:".csv,text/csv",onChange:e=>{let t=e.target.files?.[0];if(t){if("text/csv"!==t.type&&!t.name.endsWith(".csv")){h(["Please select a CSV file"]);return}d(t),h([])}},disabled:g,className:"hidden"})]})}),i&&(0,o.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-md",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-5 h-5 text-green-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{className:"text-sm text-green-800 font-medium",children:i.name}),(0,o.jsxs)("span",{className:"text-xs text-green-600 ml-2",children:["(",(i.size/1024).toFixed(1)," KB)"]})]}),o.jsx("button",{type:"button",onClick:()=>d(null),className:"text-green-600 hover:text-green-800 transition-colors",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):o.jsx("textarea",{value:l,onChange:e=>n(e.target.value),disabled:g,rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm",placeholder:"Paste your CSV data here or download the template to get started..."}),x.length>0&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,o.jsxs)("div",{className:"flex",children:[o.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,o.jsxs)("div",{className:"ml-3",children:[o.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Validation Errors"}),o.jsx("ul",{className:"mt-2 text-sm text-red-700 list-disc list-inside",children:x.map((e,t)=>o.jsx("li",{children:e},t))})]})]})})]}),"preview"===f&&(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("h4",{className:"text-md font-medium text-gray-900",children:["Preview (",c.length," attendants)"]}),o.jsx(I,{onClick:()=>v("input"),variant:"secondary",size:"sm",children:"Back to Edit"})]}),o.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-md",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50 sticky top-0",children:(0,o.jsxs)("tr",{children:[o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Congregation"}),o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Forms of Service"}),o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map((e,t)=>(0,o.jsxs)("tr",{children:[(0,o.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:[e.firstName," ",e.lastName]}),o.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.email}),o.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.congregation}),o.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.formsOfService}),o.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.isActive?"Active":"Inactive"})]},t))})]})})]}),"results"===f&&j&&(0,o.jsxs)("div",{className:"space-y-4",children:[o.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Import Results"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:j.created||0}),o.jsx("div",{className:"text-sm text-green-800",children:"Created"})]})}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j.updated||0}),o.jsx("div",{className:"text-sm text-blue-800",children:"Updated"})]})}),o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-red-600",children:j.errors?.length||0}),o.jsx("div",{className:"text-sm text-red-800",children:"Errors"})]})})]}),j.errors&&j.errors.length>0&&(0,o.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[o.jsx("h5",{className:"text-sm font-medium text-red-800 mb-2",children:"Import Errors"}),o.jsx("div",{className:"max-h-40 overflow-y-auto",children:j.errors.map((e,t)=>(0,o.jsxs)("div",{className:"text-sm text-red-700",children:["Row ",e.row," (",e.email,"): ",e.error]},t))})]})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:["input"===f&&(0,o.jsxs)(o.Fragment,{children:[o.jsx(I,{onClick:E,variant:"secondary",children:"Cancel"}),o.jsx(I,{onClick:"file"===N?()=>{if(!i){h(["Please select a CSV file"]);return}let e=new FileReader;e.onload=e=>{S(e.target?.result)},e.onerror=()=>{h(["Error reading file"])},e.readAsText(i)}:()=>{if(!l.trim()){h(["Please enter CSV data"]);return}S(l)},variant:"primary",disabled:"file"===N?!i:!l.trim(),children:"file"===N?"Process File":"Parse CSV"})]}),"preview"===f&&(0,o.jsxs)(o.Fragment,{children:[o.jsx(I,{onClick:()=>v("input"),variant:"secondary",children:"Back"}),(0,o.jsxs)(I,{onClick:C,variant:"primary",loading:g,disabled:g,children:["Import ",c.length," Attendants"]})]}),"results"===f&&o.jsx(I,{onClick:E,variant:"primary",children:"Done"})]})]})})}):null}function O({stats:e,loading:t=!1,className:s=""}){if(t)return o.jsx("div",{className:`bg-white rounded-lg shadow p-6 ${s}`,children:(0,o.jsxs)("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-gray-200 rounded mb-4"}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"h-8 bg-gray-200 rounded mb-2"}),o.jsx("div",{className:"h-4 bg-gray-200 rounded"})]},t))})]})});let r=Object.entries(e.byCongregation).sort(([,e],[,t])=>t-e).slice(0,5),a=Object.entries(e.byFormsOfService).filter(([,e])=>e>0).sort(([,e],[,t])=>t-e);return(0,o.jsxs)("div",{className:`bg-white rounded-lg shadow ${s}`,children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Attendant Statistics"})}),(0,o.jsxs)("div",{className:"p-6 space-y-6",children:[(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Overview"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,o.jsxs)("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.total}),o.jsx("div",{className:"text-sm text-blue-800",children:"Total"})]}),(0,o.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.active}),o.jsx("div",{className:"text-sm text-green-800",children:"Active"})]}),(0,o.jsxs)("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.inactive}),o.jsx("div",{className:"text-sm text-red-800",children:"Inactive"})]}),(0,o.jsxs)("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[(0,o.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[Math.round(e.active/e.total*100)||0,"%"]}),o.jsx("div",{className:"text-sm text-purple-800",children:"Active Rate"})]})]})]}),(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"User Accounts"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[o.jsx("div",{className:"text-xl font-bold text-green-600",children:e.withUsers}),o.jsx("div",{className:"text-sm text-green-800",children:"With Accounts"})]}),(0,o.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"text-xl font-bold text-gray-600",children:e.withoutUsers}),o.jsx("div",{className:"text-sm text-gray-800",children:"No Account"})]})]})]}),a.length>0&&(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Forms of Service"}),o.jsx("div",{className:"space-y-2",children:a.map(([t,s])=>(0,o.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[o.jsx(P,{form:t}),o.jsx("span",{className:"text-sm text-gray-700",children:t})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-900",children:s}),o.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${s/e.total*100}%`}})})]})]},t))})]}),r.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:["Top Congregations",Object.keys(e.byCongregation).length>5&&o.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"(showing top 5)"})]}),o.jsx("div",{className:"space-y-2",children:r.map(([t,s])=>(0,o.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[o.jsx("span",{className:"text-sm text-gray-700 truncate flex-1 mr-2",children:t}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-900",children:s}),o.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${s/e.total*100}%`}})})]})]},t))}),Object.keys(e.byCongregation).length>5&&o.jsx("div",{className:"text-center mt-2",children:(0,o.jsxs)("span",{className:"text-xs text-gray-500",children:["+",Object.keys(e.byCongregation).length-5," more congregations"]})})]}),(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Quick Insights"}),(0,o.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[o.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,o.jsxs)("span",{children:[Object.keys(e.byCongregation).length," congregations represented"]})]}),e.withUsers>0&&(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[o.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,o.jsxs)("span",{children:[Math.round(e.withUsers/e.total*100),"% have user accounts"]})]}),a.length>0&&(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[o.jsx("svg",{className:"w-4 h-4 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),(0,o.jsxs)("span",{children:["Most common: ",a[0][0]," (",a[0][1]," attendants)"]})]})]})]})]})]})}function F({eventId:e,eventName:t}){(0,g.useRouter)();let{data:s}=(0,p.useSession)(),{attendants:r,loading:a,error:l,pagination:n,stats:i,filters:d,eventInfo:c,setFilters:m,setPage:x,setPageSize:h,refresh:f,createAttendant:j,updateAttendant:N,deleteAttendant:w,bulkUpdateStatus:k,bulkDelete:S,bulkImport:A}=function({eventId:e,pageSize:t=25,includeStats:s=!0,initialFilters:r={}}){let[a,l]=(0,u.useState)([]),[n,i]=(0,u.useState)(!1),[d,c]=(0,u.useState)(null),[o,m]=(0,u.useState)(null),[x,h]=(0,u.useState)({eventId:e,eventName:void 0}),[g,p]=(0,u.useState)(r),[f,v]=(0,u.useState)({page:1,limit:t,total:0,pages:0}),j=(0,u.useCallback)(async()=>{if(!e){console.error("No eventId provided to useEventAttendants");return}try{console.log("APEX GUARDIAN: fetchEventAttendants called with:"),console.log("- eventId:",e),console.log("- pagination:",f),console.log("- filters:",g),i(!0),c(null);let t=await y.getEventAttendants(e,{...g,page:f.page,limit:f.limit});console.log("APEX GUARDIAN: API response:",t),console.log("APEX GUARDIAN: Attendants returned:",t.data?.attendants?.length||0),t.success&&t.data?(l(t.data.attendants||[]),v(t.data.pagination||{page:1,limit:25,total:0,pages:0}),h({eventId:t.data.eventId||e,eventName:t.data.eventName}),t.data.stats?m(t.data.stats):m(null)):c(t.error||"Failed to fetch event attendants")}catch(t){let e=t instanceof Error?t.message:"An error occurred";console.error("APEX GUARDIAN: fetchEventAttendants error:",e),c(e)}finally{i(!1)}},[e,g,f.page,f.limit,s]),b=(0,u.useCallback)(e=>{console.log("APEX GUARDIAN: Setting page to:",e),v(t=>{let s={...t,page:e};return console.log("APEX GUARDIAN: New pagination state:",s),s})},[]),N=(0,u.useCallback)(e=>{console.log("APEX GUARDIAN: Setting page size to:",e),v(t=>{let s={...t,limit:-1===e?999999:e,page:1};return console.log("APEX GUARDIAN: New pagination state:",s),s})},[]),w=(0,u.useCallback)(async()=>{await j()},[j]),k=(0,u.useCallback)(async t=>{try{c(null);let s=await y.createEventAttendant(e,t);if(s.success)await w();else throw Error(s.error||"Failed to create attendant")}catch(t){let e=t instanceof Error?t.message:"Failed to create attendant";throw c(e),Error(e)}},[e,w]),S=(0,u.useCallback)(async(t,s)=>{try{c(null);let r=await y.updateEventAttendant(e,t,s);if(r.success)await w();else throw Error(r.error||"Failed to update attendant")}catch(t){let e=t instanceof Error?t.message:"Failed to update attendant";throw c(e),Error(e)}},[e,w]),C=(0,u.useCallback)(async t=>{try{if(c(null),(await y.deleteEventAttendant(e,t)).success)await w();else throw Error("Failed to delete attendant")}catch(t){let e=t instanceof Error?t.message:"Failed to delete attendant";throw c(e),Error(e)}},[e,w]),A=(0,u.useCallback)(async(t,s)=>{try{c(null),await y.bulkUpdateEventAttendantStatus(e,t,s),await w()}catch(t){let e=t instanceof Error?t.message:"Failed to bulk update status";throw c(e),Error(e)}},[e,w]);return{attendants:a,loading:n,error:d,pagination:f,stats:o,filters:g,eventInfo:x,setFilters:p,setPage:b,setPageSize:N,refresh:w,createAttendant:k,updateAttendant:S,deleteAttendant:C,bulkUpdateStatus:A,bulkDelete:(0,u.useCallback)(async e=>{try{i(!0),c(null),l(t=>t.filter(t=>!e.includes(t.id)))}catch(e){c(e instanceof Error?e.message:"Failed to delete attendants")}finally{i(!1)}},[]),bulkImport:(0,u.useCallback)(async t=>{try{i(!0),c(null);let s=await y.bulkImportEventAttendants(e,t);s.success?await j():c(s.error||"Failed to import attendants")}catch(e){c(e instanceof Error?e.message:"Failed to import attendants")}finally{i(!1)}},[e,j])}}({eventId:e,pageSize:25,includeStats:!0}),[E,D]=(0,u.useState)([]),[P,$]=(0,u.useState)([]),[R,F]=(0,u.useState)(!1),[z,B]=(0,u.useState)(!1),[q,T]=(0,u.useState)(null),V=s?.user&&["ADMIN","OVERSEER"].includes(s.user.role),W=()=>{F(!1),T(null)},G=async e=>{try{q?await N(q.id,e):await j(e),W()}catch(e){console.error("Error saving attendant:",e)}},X=async e=>{if(confirm("Are you sure you want to delete this attendant?"))try{await w(e)}catch(e){console.error("Error deleting attendant:",e)}},_=async(e,t)=>{try{await k(e,t),$([])}catch(e){console.error("Error updating attendant status:",e)}},J=async e=>{if(confirm(`Are you sure you want to delete ${e.length} attendant(s)?`))try{await S(e),$([])}catch(e){console.error("Error deleting attendants:",e)}},H=async e=>{try{await A(e),B(!1)}catch(e){console.error("Error importing attendants:",e)}};return V?(0,o.jsxs)("div",{className:"space-y-6",children:[o.jsx(v(),{children:(0,o.jsxs)("title",{children:[c.eventName||t||"Event"," - Attendants | JW Attendant Scheduler"]})}),(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,o.jsxs)("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Event Attendants"}),(0,o.jsxs)("p",{className:"text-gray-600",children:["Manage attendants for ",c.eventName||t||"this event"]})]}),(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[o.jsx(b(),{href:`/events/${e}`,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:" Back to Event"}),o.jsx(I,{onClick:()=>B(!0),variant:"secondary",size:"sm",children:"Bulk Import"}),o.jsx(I,{onClick:()=>{T(null),F(!0)},variant:"primary",size:"sm",children:"Add Attendant"})]})]}),i&&o.jsx(O,{stats:i,loading:a}),o.jsx(C,{filters:d,onFiltersChange:m,congregations:E,loading:a}),l&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,o.jsxs)("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,o.jsxs)("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),o.jsx("div",{className:"mt-2 text-sm text-red-700",children:o.jsx("p",{children:l})})]})]})}),P.length>0&&o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"flex items-center",children:(0,o.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:[P.length," attendant(s) selected"]})}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[o.jsx(I,{onClick:()=>$([]),variant:"secondary",size:"sm",children:"Clear Selection"}),o.jsx(I,{onClick:()=>_(P,!0),variant:"success",size:"sm",children:"Activate Selected"}),o.jsx(I,{onClick:()=>_(P,!1),variant:"secondary",size:"sm",children:"Deactivate Selected"}),o.jsx(I,{onClick:()=>J(P),variant:"danger",size:"sm",children:"Delete Selected"})]})]})}),o.jsx("div",{className:"bg-white shadow rounded-lg",children:o.jsx(U,{attendants:r,loading:a,onEdit:e=>{T(e),F(!0)},onDelete:X,onSelect:$,selectedIds:P,onBulkStatusChange:_})}),(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 py-4 bg-white rounded-lg shadow px-4",children:[(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[(0,o.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing ",(n.page-1)*n.limit+1," to"," ",Math.min(n.page*n.limit,n.total)," of"," ",n.total," results"]}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[o.jsx("label",{htmlFor:"pageSize",className:"text-sm text-gray-700",children:"Show:"}),(0,o.jsxs)("select",{id:"pageSize",value:999999===n.limit?-1:n.limit,onChange:e=>{console.log("APEX GUARDIAN: Select changed, setPageSize function:",typeof h),console.log("APEX GUARDIAN: New value:",e.target.value),e.preventDefault(),h(Number(e.target.value))},disabled:a,className:"border border-gray-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:25,children:"25"}),o.jsx("option",{value:50,children:"50"}),o.jsx("option",{value:100,children:"100"}),o.jsx("option",{value:-1,children:"All"})]}),o.jsx("span",{className:"text-sm text-gray-700",children:"per page"})]})]}),n.pages>1&&(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[o.jsx(I,{onClick:()=>{console.log("APEX GUARDIAN: Previous button clicked, setPage function:",typeof x),console.log("APEX GUARDIAN: Current pagination:",n),x(n.page-1)},disabled:n.page<=1||a,variant:"secondary",size:"sm",type:"button",children:"Previous"}),(0,o.jsxs)("span",{className:"px-3 py-1 text-sm text-gray-700",children:["Page ",n.page," of ",n.pages]}),o.jsx(I,{onClick:()=>{console.log("APEX GUARDIAN: Next button clicked, setPage function:",typeof x),console.log("APEX GUARDIAN: Current pagination:",n),x(n.page+1)},disabled:n.page>=n.pages||a,variant:"secondary",size:"sm",type:"button",children:"Next"})]})]}),o.jsx(L,{isOpen:R,onClose:W,onSave:G,attendant:q}),o.jsx(M,{isOpen:z,onClose:()=>B(!1),onImport:H})]}):o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have permission to manage attendants."}),o.jsx(b(),{href:"/events",className:"text-blue-600 hover:text-blue-800",children:"Return to Events"})]})})}var z=s(9927);class B extends h().Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return console.error("APEX GUARDIAN: Error boundary caught error:",e),{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){console.error("APEX GUARDIAN: Error boundary componentDidCatch:",e,t),this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,o.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-red-900 mb-4",children:"\uD83D\uDEE1 APEX GUARDIAN Error Boundary"}),o.jsx("p",{className:"text-red-600 mb-4",children:"A React error was caught and contained:"}),(0,o.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-4 mb-4 text-left",children:[o.jsx("p",{className:"font-mono text-sm text-red-800",children:this.state.error?.message||"Unknown error"}),this.state.errorInfo&&(0,o.jsxs)("details",{className:"mt-2",children:[o.jsx("summary",{className:"cursor-pointer text-red-700",children:"Stack Trace"}),o.jsx("pre",{className:"mt-2 text-xs text-red-600 overflow-auto",children:this.state.errorInfo.componentStack})]})]}),o.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Reload Page"})]})}):this.props.children}}function q({eventId:e,event:t}){return o.jsx(z.Z,{title:`${t?.name||"Event"} - Attendants | JW Attendant Scheduler`,breadcrumbs:[{label:"Events",href:"/events"},{label:t?.name||"Event",href:`/events/${e}`},{label:"Attendants"}],selectedEvent:{id:e,name:t?.name||"Event",status:t?.status},children:o.jsx(B,{children:o.jsx(F,{eventId:e,eventName:t?.name})})})}let T=async e=>{if(!await (0,m.getServerSession)(e.req,e.res,x.L))return{redirect:{destination:"/auth/signin",permanent:!1}};let{id:t}=e.params,r=null;try{let{prisma:e}=await Promise.resolve().then(s.bind(s,8925)),a=await e.events.findUnique({where:{id:t}});a&&(r={id:a.id,name:a.name,eventType:a.eventType,startDate:a.startDate.toISOString(),endDate:a.endDate.toISOString(),status:a.status})}catch(e){console.error("Error fetching event:",e),r=null}return{props:{eventId:t,event:r}}},V=(0,n.l)(r,"default"),W=(0,n.l)(r,"getStaticProps"),G=(0,n.l)(r,"getStaticPaths"),X=(0,n.l)(r,"getServerSideProps"),_=(0,n.l)(r,"config"),J=(0,n.l)(r,"reportWebVitals"),H=(0,n.l)(r,"unstable_getStaticProps"),Z=(0,n.l)(r,"unstable_getStaticPaths"),K=(0,n.l)(r,"unstable_getStaticParams"),Q=(0,n.l)(r,"unstable_getServerProps"),Y=(0,n.l)(r,"unstable_getServerSideProps"),ee=new a.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/events/[id]/attendants",pathname:"/events/[id]/attendants",bundlePath:"",filename:""},components:{App:c.default,Document:d()},userland:r})},9927:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var r=s(997),a=s(1649),l=s(1664),n=s.n(l),i=s(1163);function d({children:e,title:t="JW Attendant Scheduler",breadcrumbs:s=[],selectedEvent:l}){let{data:d}=(0,a.useSession)(),c=(0,i.useRouter)(),o=[{label:"Events",href:"/events",icon:"\uD83D\uDCC5",roles:["ADMIN","OVERSEER","ATTENDANT"]},{label:"Event Selection",href:"/events/select",icon:"\uD83C\uDFAF",roles:["ADMIN","OVERSEER","ATTENDANT"]}];d?.user?.role==="ADMIN"&&o.push({label:"Admin Portal",href:"/admin",icon:"\uD83D\uDEE1",roles:["ADMIN"]});let m=o.filter(e=>e.roles.includes(d?.user?.role||""));return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)(n(),{href:"/events/select",className:"flex items-center",children:[r.jsx("span",{className:"text-2xl font-bold text-blue-600",children:"\uD83D\uDCCB"}),r.jsx("span",{className:"ml-2 text-xl font-semibold text-gray-900",children:"JW Attendant Scheduler"})]}),r.jsx("div",{className:"hidden md:ml-8 md:flex md:space-x-4",children:m.map(e=>(0,r.jsxs)(n(),{href:e.href,className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${c.pathname.startsWith(e.href)?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[r.jsx("span",{className:"mr-2",children:e.icon}),e.label]},e.href))})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[l&&(0,r.jsxs)("div",{className:"hidden md:flex items-center bg-blue-50 px-3 py-1 rounded-lg",children:[(0,r.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["\uD83D\uDCC5 ",l.name]}),l.status&&r.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${"current"===l.status?"bg-green-100 text-green-800":"upcoming"===l.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:l.status})]}),d?.user&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("span",{className:"text-sm text-gray-700",children:d.user.name}),r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${"ADMIN"===d.user.role?"bg-red-100 text-red-800":"OVERSEER"===d.user.role?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:d.user.role}),r.jsx("button",{onClick:()=>{(0,a.signOut)({callbackUrl:"/auth/signin"})},className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"Sign Out"})]})]})]})})}),s.length>0&&r.jsx("div",{className:"bg-white border-b border-gray-200",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:r.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:r.jsx("ol",{className:"flex items-center space-x-2",children:s.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center",children:[t>0&&r.jsx("svg",{className:"w-4 h-4 text-gray-400 mx-2",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.href?r.jsx(n(),{href:e.href,className:"text-sm text-blue-600 hover:text-blue-800",children:e.label}):r.jsx("span",{className:"text-sm text-gray-500",children:e.label})]},t))})})})}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t&&r.jsx("div",{className:"mb-8",children:r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t})}),e]})]})}},6814:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(997),a=s(1649);function l({Component:e,pageProps:{session:t,...s}}){return r.jsx(a.SessionProvider,{session:t,children:r.jsx(e,{...s})})}s(6764)},5175:(e,t,s)=>{"use strict";s.d(t,{L:()=>o});var r=s(3227),a=s.n(r);let l=require("next-auth/providers/credentials");var n=s.n(l),i=s(8925);let d=require("bcryptjs");var c=s.n(d);let o={providers:[n()({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await i.prisma.users.findUnique({where:{email:e.email}});return t&&t.passwordHash&&await c().compare(e.password,t.passwordHash)?{id:t.id,email:t.email,name:`${t.firstName} ${t.lastName}`,role:t.role}:null}})],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.sub,e.user.role=t.role),e)},pages:{signIn:"/auth/signin"},session:{strategy:"jwt",maxAge:2592e3},cookies:{sessionToken:{name:"__Secure-next-auth.session-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:!0}}},secret:"staging-nextauth-secret-2024"};a()(o)},8925:(e,t,s)=>{"use strict";s.r(t),s.d(t,{prisma:()=>a});let r=require("@prisma/client"),a=globalThis.prisma??new r.PrismaClient},6764:()=>{},3227:e=>{"use strict";e.exports=require("next-auth")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{"use strict";e.exports=require("next/head")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[2899,8342,1664],()=>s(2850));module.exports=r})();