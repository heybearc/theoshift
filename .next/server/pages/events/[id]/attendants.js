(()=>{var e={};e.id=7199,e.ids=[7199,2888,660],e.modules={7601:(e,t,s)=>{"use strict";s.r(t),s.d(t,{config:()=>N,default:()=>f,getServerSideProps:()=>j,getStaticPaths:()=>y,getStaticProps:()=>v,reportWebVitals:()=>w,routeModule:()=>E,unstable_getServerProps:()=>C,unstable_getServerSideProps:()=>O,unstable_getStaticParams:()=>k,unstable_getStaticPaths:()=>A,unstable_getStaticProps:()=>S});var a={};s.r(a),s.d(a,{default:()=>p,getServerSideProps:()=>b});var r=s(7093),l=s(5244),n=s(1323),i=s(2899),d=s.n(i),o=s(6814),c=s(997),m=s(3227),x=s(5175),u=s(9927),h=s(6689),g=s(1163);function p({eventId:e,event:t,attendants:s,stats:a}){let r=(0,g.useRouter)(),[l,n]=(0,h.useState)(!1),[i,d]=(0,h.useState)(!1),[o,m]=(0,h.useState)(!1),[x,p]=(0,h.useState)(null),[b,f]=(0,h.useState)(null),[v,y]=(0,h.useState)(new Set),[j,N]=(0,h.useState)({isActive:"",congregation:"",formsOfService:""}),[w,S]=(0,h.useState)({search:"",congregation:"",isActive:"all"}),[A,k]=(0,h.useState)(1),[C,O]=(0,h.useState)(!1),[E,D]=(0,h.useState)(null),[P,I]=(0,h.useState)({firstName:"",lastName:"",email:"",phone:"",congregation:"",formsOfService:"",notes:"",isActive:!0}),$=()=>{I({firstName:"",lastName:"",email:"",phone:"",congregation:"",formsOfService:"",notes:"",isActive:!0}),p(null),n(!0)},q=e=>{I({firstName:e.firstName,lastName:e.lastName,email:e.email,phone:e.phone||"",congregation:e.congregation||"",formsOfService:Array.isArray(e.formsOfService)?e.formsOfService.join(", "):e.formsOfService||"",notes:"",isActive:e.isActive}),p(e),n(!0)},T=async t=>{t.preventDefault(),O(!0);try{let t=x?`/api/events/${e}/attendants/${x.associationId}`:`/api/events/${e}/attendants`,s=await fetch(t,{method:x?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(s.ok)n(!1),r.reload();else{let e=await s.json();alert(e.error||"Failed to save attendant")}}catch(e){console.error("Error saving attendant:",e),alert("Failed to save attendant")}finally{O(!1)}},R=async t=>{if(confirm(`Are you sure you want to remove ${t.firstName} ${t.lastName}?`)){O(!0);try{let s=await fetch(`/api/events/${e}/attendants/${t.associationId}`,{method:"DELETE"});if(s.ok)r.reload();else{let e=await s.json();alert(e.error||"Failed to remove attendant")}}catch(e){console.error("Error removing attendant:",e),alert("Failed to remove attendant")}finally{O(!1)}}},F=async()=>{if(b){O(!0);try{let t=(await b.text()).split("\n").filter(e=>e.trim());if(t.length<2){alert("CSV file must have at least a header row and one data row");return}let s=t[0].split(",").map(e=>e.trim().replace(/"/g,"")),a=[];for(let e=1;e<t.length;e++){let r=t[e].split(",").map(e=>e.trim().replace(/"/g,"")),l={};s.forEach((e,t)=>{let s=r[t]||"";switch(e.toLowerCase()){case"firstname":l.firstName=s;break;case"lastname":l.lastName=s;break;case"email":l.email=s;break;case"phone":l.phone=s;break;case"congregation":l.congregation=s;break;case"formsofservice":l.formsOfService=s;break;case"notes":l.notes=s;break;case"isactive":l.isActive="true"===s.toLowerCase()}}),l.firstName&&l.lastName&&l.email&&a.push(l)}if(0===a.length){alert("No valid attendant records found in CSV");return}let l=await fetch(`/api/events/${e}/attendants`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({attendants:a})}),n=await l.json();n.success?(D(n.data),d(!1),r.reload(),alert(`Successfully imported ${a.length} attendants`)):alert(`Import failed: ${n.error}`)}catch(e){console.error("Import error:",e),alert("Failed to parse CSV file. Please check the format.")}finally{O(!1)}}},_=e=>{let t=new Set(v);t.has(e)?t.delete(e):t.add(e),y(t)},U=async()=>{if(0!==v.size){O(!0);try{let t=[];for(let s of v){let a={};""!==j.isActive&&(a.isActive="true"===j.isActive),""!==j.congregation&&(a.congregation=j.congregation),""!==j.formsOfService&&(a.formsOfService=j.formsOfService),Object.keys(a).length>0&&t.push(fetch(`/api/events/${e}/attendants/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}))}await Promise.all(t),m(!1),y(new Set),N({isActive:"",formsOfService:"",congregation:""}),r.reload()}catch(e){console.error("Bulk edit error:",e),alert("Failed to update attendants")}finally{O(!1)}}};return c.jsx(u.Z,{title:`${t.name} - Attendants | JW Attendant Scheduler`,breadcrumbs:[{label:"Events",href:"/events"},{label:t.name,href:`/events/${e}`},{label:"Attendants"}],selectedEvent:{id:e,name:t.name,status:t.status},children:(0,c.jsxs)("div",{className:"max-w-7xl mx-auto",children:[c.jsx("div",{className:"mb-6",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Event Attendants"}),(0,c.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Manage attendants for ",t.name]})]}),(0,c.jsxs)("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:()=>r.push(`/events/${e}`),className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded transition-colors",children:"← Back to Event"}),c.jsx("button",{onClick:$,disabled:C,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-bold py-2 px-4 rounded transition-colors",children:"➕ Add Attendant"}),c.jsx("button",{onClick:()=>{d(!0),f(null),D(null)},disabled:C,className:"bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white font-bold py-2 px-4 rounded transition-colors",children:"\uD83D\uDCE5 Import Attendants"}),v.size>0&&(0,c.jsxs)("button",{onClick:()=>{if(0===v.size){alert("Please select attendants to edit");return}m(!0)},disabled:C,className:"bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white font-bold py-2 px-4 rounded transition-colors",children:["✏️ Bulk Edit (",v.size,")"]})]})]})}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[c.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:c.jsx("div",{className:"p-5",children:(0,c.jsxs)("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold",children:a.total})})}),c.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,c.jsxs)("dl",{children:[c.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Attendants"}),c.jsx("dd",{className:"text-lg font-medium text-gray-900",children:a.total})]})})]})})}),c.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:c.jsx("div",{className:"p-5",children:(0,c.jsxs)("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold",children:a.active})})}),c.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,c.jsxs)("dl",{children:[c.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active"}),c.jsx("dd",{className:"text-lg font-medium text-gray-900",children:a.active})]})})]})})}),c.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:c.jsx("div",{className:"p-5",children:(0,c.jsxs)("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("div",{className:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold",children:a.inactive})})}),c.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,c.jsxs)("dl",{children:[c.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Inactive"}),c.jsx("dd",{className:"text-lg font-medium text-gray-900",children:a.inactive})]})})]})})})]}),c.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:(0,c.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Attendants List"}),0===s.length?(0,c.jsxs)("div",{className:"text-center py-8",children:[c.jsx("p",{className:"text-gray-500",children:"No attendants found for this event"}),c.jsx("button",{onClick:$,disabled:C,className:"mt-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-bold py-2 px-4 rounded transition-colors",children:"Add First Attendant"})]}):c.jsx("div",{className:"overflow-x-auto",children:(0,c.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:(0,c.jsxs)("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c.jsx("input",{type:"checkbox",checked:v.size===s.length&&s.length>0,onChange:()=>{v.size===s.length?y(new Set):y(new Set(s.map(e=>e.associationId)))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Congregation"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Forms of Service"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,c.jsxs)("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("input",{type:"checkbox",checked:v.has(e.associationId),onChange:()=>_(e.associationId),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,c.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.firstName," ",e.lastName]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm text-gray-900",children:e.email})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm text-gray-900",children:e.congregation||"N/A"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"flex flex-wrap gap-1",children:(Array.isArray(e.formsOfService)?e.formsOfService:(e.formsOfService||"").toString().split(", ").filter(e=>e.trim())).map((e,t)=>c.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${"Overseer"===e?"bg-purple-100 text-purple-800":"Keyman"===e?"bg-blue-100 text-blue-800":"Elder"===e?"bg-yellow-100 text-yellow-800":"Ministerial Servant"===e?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e},t))})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.isActive?"Active":"Inactive"})}),(0,c.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[c.jsx("button",{onClick:()=>q(e),disabled:C,className:"text-blue-600 hover:text-blue-900 disabled:text-blue-400 mr-3",children:"Edit"}),c.jsx("button",{onClick:()=>R(e),disabled:C,className:"text-red-600 hover:text-red-900 disabled:text-red-400",children:"Remove"})]})]},e.id))})]})})]})}),l&&c.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:c.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,c.jsxs)("div",{className:"mt-3",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:x?"Edit Attendant":"Add New Attendant"}),(0,c.jsxs)("form",{onSubmit:T,children:[(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name *"}),c.jsx("input",{type:"text",required:!0,value:P.firstName,onChange:e=>I({...P,firstName:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name *"}),c.jsx("input",{type:"text",required:!0,value:P.lastName,onChange:e=>I({...P,lastName:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email *"}),c.jsx("input",{type:"email",required:!0,value:P.email,onChange:e=>I({...P,email:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),c.jsx("input",{type:"tel",value:P.phone,onChange:e=>I({...P,phone:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Congregation"}),c.jsx("input",{type:"text",value:P.congregation,onChange:e=>I({...P,congregation:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter congregation name"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Forms of Service *"}),c.jsx("div",{className:"mt-2 space-y-2",children:["Elder","Ministerial Servant","Regular Pioneer","Overseer","Keyman","Other Dept."].map(e=>(0,c.jsxs)("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:P.formsOfService.split(", ").filter(e=>e.trim()).includes(e),onChange:t=>{let s=P.formsOfService.split(", ").filter(e=>e.trim());t.target.checked?I({...P,formsOfService:[...s,e].join(", ")}):I({...P,formsOfService:s.filter(t=>t!==e).join(", ")})},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),c.jsx("span",{className:"ml-2 text-sm text-gray-700",children:e})]},e))}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Select all applicable forms of service. Overseers manage Keymen and Attendants. Keymen manage groups of Attendants."})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),c.jsx("textarea",{value:P.notes,onChange:e=>I({...P,notes:e.target.value}),rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Additional notes or comments"})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:!1!==P.isActive,onChange:e=>I({...P,isActive:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),c.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Active Attendant"})]}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Inactive attendants will not be available for new assignments"})]})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{type:"button",onClick:()=>n(!1),disabled:C,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:bg-gray-100",children:"Cancel"}),(0,c.jsxs)("button",{type:"submit",disabled:C,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-md",children:[C?"Saving...":x?"Update":"Add"," Attendant"]})]})]})]})})}),i&&c.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:c.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,c.jsxs)("div",{className:"mt-3",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Import Attendants"}),(0,c.jsxs)("div",{className:"mb-4",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Upload a CSV file with attendant information."}),c.jsx("button",{onClick:()=>{let e=new Blob([`firstName,lastName,email,phone,congregation,formsOfService,notes,isActive
John,Doe,john.doe@example.com,555-1234,Central Congregation,"Elder, Overseer",,true
Jane,Smith,jane.smith@example.com,555-5678,North Congregation,"Ministerial Servant, Keyman",,true
Bob,Johnson,bob.johnson@example.com,,South Congregation,"Regular Pioneer",,true`],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="attendants-import-template.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(t)},className:"text-blue-600 hover:text-blue-800 text-sm underline",children:"\uD83D\uDCE5 Download CSV Template"})]}),(0,c.jsxs)("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select CSV File"}),c.jsx("input",{type:"file",accept:".csv",onChange:e=>{let t=e.target.files?.[0];t&&"text/csv"===t.type?f(t):alert("Please select a valid CSV file")},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),b&&c.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded",children:(0,c.jsxs)("p",{className:"text-sm text-green-800",children:["✅ File selected: ",b.name]})}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:()=>d(!1),disabled:C,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:bg-gray-100",children:"Cancel"}),c.jsx("button",{onClick:F,disabled:C||!b,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white rounded-md",children:C?"Importing...":"Import Attendants"})]})]})})}),o&&c.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:c.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,c.jsxs)("div",{className:"mt-3",children:[(0,c.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Bulk Edit ",v.size," Attendants"]}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,c.jsxs)("select",{value:j.isActive,onChange:e=>N({...j,isActive:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"No Change"}),c.jsx("option",{value:"true",children:"Active"}),c.jsx("option",{value:"false",children:"Inactive"})]})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Congregation"}),c.jsx("input",{type:"text",value:j.congregation,onChange:e=>N({...j,congregation:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Leave empty for no change"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Forms of Service (comma-separated)"}),c.jsx("input",{type:"text",value:j.formsOfService,onChange:e=>N({...j,formsOfService:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Elder, Overseer (leave empty for no change)"})]})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{type:"button",onClick:()=>m(!1),disabled:C,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:bg-gray-100",children:"Cancel"}),c.jsx("button",{onClick:U,disabled:C,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white rounded-md",children:C?"Updating...":"Update Attendants"})]})]})})})]})})}let b=async e=>{if(!await (0,m.getServerSession)(e.req,e.res,x.L))return{redirect:{destination:"/auth/signin",permanent:!1}};let{id:t}=e.params;try{let{prisma:e}=await Promise.resolve().then(s.bind(s,8925)),a=await e.events.findUnique({where:{id:t},include:{event_attendant_associations:{include:{attendants:{select:{id:!0,firstName:!0,lastName:!0,email:!0,phone:!0,congregation:!0,formsOfService:!0,isActive:!0,createdAt:!0}}}}}});if(!a)return{notFound:!0};let r={id:a.id,name:a.name,eventType:a.eventType,startDate:a.startDate?.toISOString()||null,endDate:a.endDate?.toISOString()||null,status:a.status},l=a.event_attendant_associations.filter(e=>e.attendants).map(e=>({id:e.attendants.id,firstName:e.attendants.firstName,lastName:e.attendants.lastName,email:e.attendants.email,phone:e.attendants.phone,congregation:e.attendants.congregation,formsOfService:e.attendants.formsOfService,isActive:e.attendants.isActive,createdAt:e.attendants.createdAt?.toISOString()||null,associationId:e.id}));return{props:{eventId:t,event:r,attendants:l,stats:{total:l.length,active:l.filter(e=>e.isActive).length,inactive:l.filter(e=>!e.isActive).length}}}}catch(e){return console.error("Error fetching attendants data:",e),{notFound:!0}}},f=(0,n.l)(a,"default"),v=(0,n.l)(a,"getStaticProps"),y=(0,n.l)(a,"getStaticPaths"),j=(0,n.l)(a,"getServerSideProps"),N=(0,n.l)(a,"config"),w=(0,n.l)(a,"reportWebVitals"),S=(0,n.l)(a,"unstable_getStaticProps"),A=(0,n.l)(a,"unstable_getStaticPaths"),k=(0,n.l)(a,"unstable_getStaticParams"),C=(0,n.l)(a,"unstable_getServerProps"),O=(0,n.l)(a,"unstable_getServerSideProps"),E=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/events/[id]/attendants",pathname:"/events/[id]/attendants",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:a})},9927:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var a=s(997),r=s(1649),l=s(1664),n=s.n(l),i=s(1163);function d({children:e,title:t="JW Attendant Scheduler",breadcrumbs:s=[],selectedEvent:l}){let{data:d}=(0,r.useSession)(),o=(0,i.useRouter)(),c=[{label:"Events",href:"/events",icon:"\uD83D\uDCC5",roles:["ADMIN","OVERSEER","ATTENDANT"]},{label:"Event Selection",href:"/events/select",icon:"\uD83C\uDFAF",roles:["ADMIN","OVERSEER","ATTENDANT"]}];d?.user?.role==="ADMIN"&&c.push({label:"Admin Portal",href:"/admin",icon:"\uD83D\uDEE1️",roles:["ADMIN"]});let m=c.filter(e=>e.roles.includes(d?.user?.role||""));return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)(n(),{href:"/events/select",className:"flex items-center",children:[a.jsx("span",{className:"text-2xl font-bold text-blue-600",children:"\uD83D\uDCCB"}),a.jsx("span",{className:"ml-2 text-xl font-semibold text-gray-900",children:"JW Attendant Scheduler"})]}),a.jsx("div",{className:"hidden md:ml-8 md:flex md:space-x-4",children:m.map(e=>(0,a.jsxs)(n(),{href:e.href,className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${o.pathname.startsWith(e.href)?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[a.jsx("span",{className:"mr-2",children:e.icon}),e.label]},e.href))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[l&&(0,a.jsxs)("div",{className:"hidden md:flex items-center bg-blue-50 px-3 py-1 rounded-lg",children:[(0,a.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["\uD83D\uDCC5 ",l.name]}),l.status&&a.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${"current"===l.status?"bg-green-100 text-green-800":"upcoming"===l.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:l.status})]}),d?.user&&(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("span",{className:"text-sm text-gray-700",children:d.user.name}),a.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${"ADMIN"===d.user.role?"bg-red-100 text-red-800":"OVERSEER"===d.user.role?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:d.user.role}),a.jsx("button",{onClick:()=>{(0,r.signOut)({callbackUrl:"/auth/signin"})},className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"Sign Out"})]})]})]})})}),s.length>0&&a.jsx("div",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:a.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:a.jsx("ol",{className:"flex items-center space-x-2",children:s.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center",children:[t>0&&a.jsx("svg",{className:"w-4 h-4 text-gray-400 mx-2",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.href?a.jsx(n(),{href:e.href,className:"text-sm text-blue-600 hover:text-blue-800",children:e.label}):a.jsx("span",{className:"text-sm text-gray-500",children:e.label})]},t))})})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t&&a.jsx("div",{className:"mb-8",children:a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t})}),e]})]})}},6814:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(997),r=s(1649);function l({Component:e,pageProps:{session:t,...s}}){return a.jsx(r.SessionProvider,{session:t,children:a.jsx(e,{...s})})}s(6764)},5175:(e,t,s)=>{"use strict";s.d(t,{L:()=>c});var a=s(3227),r=s.n(a);let l=require("next-auth/providers/credentials");var n=s.n(l),i=s(8925);let d=require("bcryptjs");var o=s.n(d);let c={providers:[n()({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await i.prisma.users.findUnique({where:{email:e.email}});return t&&t.passwordHash&&await o().compare(e.password,t.passwordHash)?{id:t.id,email:t.email,name:`${t.firstName} ${t.lastName}`,role:t.role}:null}})],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.sub,e.user.role=t.role),e)},pages:{signIn:"/auth/signin"},session:{strategy:"jwt",maxAge:2592e3},cookies:{sessionToken:{name:"__Secure-next-auth.session-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:!0}}},secret:"staging-nextauth-secret-2024"};r()(c)},8925:(e,t,s)=>{"use strict";s.r(t),s.d(t,{prisma:()=>r});let a=require("@prisma/client"),r=globalThis.prisma??new a.PrismaClient},6764:()=>{},3227:e=>{"use strict";e.exports=require("next-auth")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[2899,8342,1664],()=>s(7601));module.exports=a})();