(()=>{var e={};e.id=681,e.ids=[681,888,660],e.modules={8381:(e,t,s)=>{"use strict";s.r(t),s.d(t,{config:()=>D,default:()=>f,getServerSideProps:()=>w,getStaticPaths:()=>v,getStaticProps:()=>N,reportWebVitals:()=>S,routeModule:()=>$,unstable_getServerProps:()=>P,unstable_getServerSideProps:()=>k,unstable_getStaticParams:()=>A,unstable_getStaticPaths:()=>C,unstable_getStaticProps:()=>E});var a={};s.r(a),s.d(a,{default:()=>y,getServerSideProps:()=>j});var r=s(7093),n=s(5244),l=s(1323),i=s(2899),d=s.n(i),c=s(6814),o=s(997),m=s(3227),x=s(5175),u=s(9061),h=s(6689),g=s(1664),p=s.n(g),b=s(1163);function y(){let e=(0,b.useRouter)(),{id:t,attendantId:s}=e.query,[a,r]=(0,h.useState)(null),[n,l]=(0,h.useState)([]),[i,d]=(0,h.useState)(!0),[c,m]=(0,h.useState)(""),[x,g]=(0,h.useState)(""),[y,j]=(0,h.useState)(!1),[f,N]=(0,h.useState)(""),[v,w]=(0,h.useState)(""),D=async()=>{if(t&&s)try{d(!0);let e=await fetch(`/api/admin/events/${t}/attendants/${s}`),a=await e.json();a.success?(r(a.data.association),l(a.data.assignments),N(a.data.association.role||""),w(a.data.association.notes||"")):m("Failed to fetch attendant details")}catch(e){m("Error fetching attendant details"),console.error("Error:",e)}finally{d(!1)}},S=async()=>{try{let e=await fetch(`/api/admin/events/${t}/attendants/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:f||void 0,notes:v||void 0})}),a=await e.json();a.success?(g("Attendant updated successfully!"),j(!1),D(),setTimeout(()=>g(""),3e3)):m(a.error||"Failed to update attendant")}catch(e){m("Error updating attendant"),console.error("Error:",e)}},E=async()=>{if(confirm("Are you sure you want to remove this attendant from the event? This will also remove all their assignments."))try{let a=await fetch(`/api/admin/events/${t}/attendants/${s}`,{method:"DELETE"}),r=await a.json();r.success?(g("Attendant removed successfully!"),setTimeout(()=>{e.push(`/admin/events/${t}/attendants`)},1500)):m(r.error||"Failed to remove attendant")}catch(e){m("Error removing attendant"),console.error("Error:",e)}},C=e=>new Date(`2000-01-01T${e}`).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),A=e=>({ASSIGNED:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-green-100 text-green-800",DECLINED:"bg-red-100 text-red-800",COMPLETED:"bg-blue-100 text-blue-800",NO_SHOW:"bg-gray-100 text-gray-800"})[e]||"bg-gray-100 text-gray-800";return i?o.jsx(u.Z,{children:o.jsx("div",{className:"max-w-7xl mx-auto",children:(0,o.jsxs)("div",{className:"flex items-center justify-center h-64",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),o.jsx("p",{className:"ml-3 text-gray-600",children:"Loading attendant details..."})]})})}):c||!a?o.jsx(u.Z,{children:o.jsx("div",{className:"max-w-7xl mx-auto",children:(0,o.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-8 text-center",children:[o.jsx("p",{className:"text-red-700",children:c||"Attendant not found"}),o.jsx(p(),{href:`/admin/events/${t}/attendants`,className:"mt-4 inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition-colors",children:"← Back to Attendants"})]})})}):o.jsx(u.Z,{children:(0,o.jsxs)("div",{className:"max-w-7xl mx-auto",children:[o.jsx("div",{className:"mb-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:[a.users.firstName," ",a.users.lastName]}),(0,o.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Attendant for: ",o.jsx("span",{className:"font-medium",children:a.events.name})]})]}),(0,o.jsxs)("div",{className:"flex space-x-3",children:[o.jsx(p(),{href:`/admin/events/${t}/attendants`,className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded transition-colors",children:"← Back to Attendants"}),o.jsx("button",{onClick:()=>j(!y),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition-colors",children:y?"✕ Cancel Edit":"✏️ Edit"}),o.jsx("button",{onClick:E,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition-colors",children:"\uD83D\uDDD1️ Remove"})]})]})}),c&&(0,o.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[o.jsx("p",{className:"text-red-700",children:c}),o.jsx("button",{onClick:()=>m(""),className:"mt-2 text-red-600 hover:text-red-800",children:"✕ Dismiss"})]}),x&&o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:o.jsx("p",{className:"text-green-700",children:x})}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,o.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,o.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Attendant Information"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Full Name"}),(0,o.jsxs)("p",{className:"mt-1 text-sm text-gray-900",children:[a.users.firstName," ",a.users.lastName]})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Email"}),o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.users.email})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"System Role"}),o.jsx("span",{className:`mt-1 inline-block px-2 py-1 text-xs rounded-full ${{ADMIN:"bg-red-100 text-red-800",OVERSEER:"bg-purple-100 text-purple-800",ASSISTANT_OVERSEER:"bg-blue-100 text-blue-800",KEYMAN:"bg-green-100 text-green-800",ATTENDANT:"bg-gray-100 text-gray-800"}[a.users.role]||"bg-gray-100 text-gray-800"}`,children:a.users.role})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Event Role"}),y?o.jsx("input",{type:"text",value:f,onChange:e=>N(e.target.value),placeholder:"e.g., Security Team Leader",className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.role||"Not specified"})]}),(0,o.jsxs)("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Notes"}),y?o.jsx("textarea",{value:v,onChange:e=>w(e.target.value),rows:3,placeholder:"Additional notes about this attendant...",className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.notes||"No notes"})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Added to Event"}),o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(a.createdAt).toLocaleDateString()})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Last Updated"}),o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(a.updatedAt).toLocaleDateString()})]})]}),y&&o.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,o.jsxs)("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>{j(!1),N(a.role||""),w(a.notes||"")},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),o.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Save Changes"})]})})]}),(0,o.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Assignments (",n.length,")"]}),o.jsx(p(),{href:`/admin/events/${t}/assignments?attendant=${s}`,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm transition-colors",children:"➕ Add Assignment"})]}),0===n.length?(0,o.jsxs)("div",{className:"text-center py-8",children:[o.jsx("p",{className:"text-gray-500",children:"No assignments yet"}),o.jsx(p(),{href:`/admin/events/${t}/assignments?attendant=${s}`,className:"mt-2 inline-block text-blue-600 hover:text-blue-800",children:"Create first assignment →"})]}):o.jsx("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Position"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Department"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Shift Time"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:n.map(e=>(0,o.jsxs)("tr",{children:[o.jsx("td",{className:"px-6 py-4",children:(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["#",e.event_positions.positionNumber," - ",e.event_positions.title]}),e.event_positions.description&&o.jsx("div",{className:"text-sm text-gray-500",children:e.event_positions.description})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.event_positions.department}),(0,o.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[C(e.shiftStart)," - ",C(e.shiftEnd)]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${A(e.status)}`,children:e.status})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:o.jsx(p(),{href:`/admin/events/${t}/assignments/${e.id}`,className:"text-blue-600 hover:text-blue-900 transition-colors",children:"\uD83D\uDCCB Manage"})})]},e.id))})]})})]})]}),(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Stats"}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Total Assignments"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:n.length})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Confirmed"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:n.filter(e=>"CONFIRMED"===e.status).length})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Pending"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:n.filter(e=>"ASSIGNED"===e.status).length})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Completed"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:n.filter(e=>"COMPLETED"===e.status).length})]})]})]}),(0,o.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Event Information"}),(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Event Name"}),o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.events.name})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Event Type"}),o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.events.eventType})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Event Date"}),o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(a.events.startDate).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]})]}),(0,o.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Actions"}),(0,o.jsxs)("div",{className:"space-y-3",children:[o.jsx(p(),{href:`/admin/events/${t}/assignments?attendant=${s}`,className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDCCB Manage Assignments"}),o.jsx(p(),{href:`/admin/events/${t}`,className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDCC5 View Event Details"}),o.jsx(p(),{href:`/admin/users/${a.users.id}`,className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDC64 View User Profile"}),o.jsx("button",{onClick:()=>window.print(),className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDDA8️ Print Details"})]})]})]})]})]})})}let j=async e=>{let t=await (0,m.getServerSession)(e.req,e.res,x.L);return t?{props:{session:t}}:{redirect:{destination:"/auth/signin",permanent:!1}}},f=(0,l.l)(a,"default"),N=(0,l.l)(a,"getStaticProps"),v=(0,l.l)(a,"getStaticPaths"),w=(0,l.l)(a,"getServerSideProps"),D=(0,l.l)(a,"config"),S=(0,l.l)(a,"reportWebVitals"),E=(0,l.l)(a,"unstable_getStaticProps"),C=(0,l.l)(a,"unstable_getStaticPaths"),A=(0,l.l)(a,"unstable_getStaticParams"),P=(0,l.l)(a,"unstable_getServerProps"),k=(0,l.l)(a,"unstable_getServerSideProps"),$=new r.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/event-attendants/[eventId]/[attendantId]",pathname:"/event-attendants/[eventId]/[attendantId]",bundlePath:"",filename:""},components:{App:c.default,Document:d()},userland:a})},9061:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var a=s(997),r=s(1163),n=s(1649),l=s(1664),i=s.n(l);function d({children:e,title:t,breadcrumbs:s=[]}){let l=(0,r.useRouter)(),{data:d}=(0,n.useSession)(),c=async()=>{await (0,n.signOut)({callbackUrl:"/auth/signin"})};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[a.jsx("div",{className:"flex items-center",children:(0,a.jsxs)(i(),{href:"/admin",className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-sm",children:"JW"})})}),a.jsx("div",{className:"ml-3",children:a.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Admin Portal"})})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Welcome, ",d?.user?.name]}),a.jsx("button",{onClick:c,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Sign Out"})]})]})})}),(0,a.jsxs)("div",{className:"flex",children:[a.jsx("nav",{className:"w-64 bg-white shadow-sm min-h-screen border-r border-gray-200",children:a.jsx("div",{className:"p-4",children:a.jsx("ul",{className:"space-y-2",children:[{label:"Dashboard",href:"/admin",icon:"\uD83C\uDFE0"},{label:"User Management",href:"/admin/users",icon:"\uD83D\uDC65"},{label:"Health Monitor",href:"/admin/health",icon:"\uD83D\uDC9A"},{label:"API Status",href:"/admin/api-status",icon:"\uD83D\uDCCA"},{label:"Audit Logs",href:"/admin/audit-logs",icon:"\uD83D\uDCCB"},{label:"System Operations",href:"/admin/system-ops",icon:"⚡"},{label:"Email Configuration",href:"/admin/email-config",icon:"\uD83D\uDCE7"}].map(e=>{let t=l.pathname===e.href||"/admin"!==e.href&&l.pathname.startsWith(e.href);return a.jsx("li",{children:(0,a.jsxs)(i(),{href:e.href,className:`flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ${t?"bg-blue-50 text-blue-700 border-r-2 border-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[a.jsx("span",{className:"mr-3",children:e.icon}),e.label]})},e.href)})})})}),(0,a.jsxs)("main",{className:"flex-1",children:[s.length>0&&a.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-3",children:a.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:(0,a.jsxs)("ol",{className:"flex items-center space-x-2",children:[a.jsx("li",{children:a.jsx(i(),{href:"/admin",className:"text-gray-500 hover:text-gray-700",children:"Dashboard"})}),s.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("svg",{className:"flex-shrink-0 h-4 w-4 text-gray-400 mx-2",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.href?a.jsx(i(),{href:e.href,className:"text-gray-500 hover:text-gray-700",children:e.label}):a.jsx("span",{className:"text-gray-900 font-medium",children:e.label})]},t))]})})}),(0,a.jsxs)("div",{className:"p-6",children:[t&&a.jsx("div",{className:"mb-6",children:a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t})}),e]})]})]})]})}},6814:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(997),r=s(1649);function n({Component:e,pageProps:{session:t,...s}}){return a.jsx(r.SessionProvider,{session:t,children:a.jsx(e,{...s})})}s(6764)},5175:(e,t,s)=>{"use strict";s.d(t,{L:()=>o});var a=s(3227),r=s.n(a);let n=require("next-auth/providers/credentials");var l=s.n(n),i=s(8925);let d=require("bcryptjs");var c=s.n(d);let o={providers:[l()({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await i.prisma.users.findUnique({where:{email:e.email}});return t&&t.passwordHash&&await c().compare(e.password,t.passwordHash)?{id:t.id,email:t.email,name:`${t.firstName} ${t.lastName}`,role:t.role}:null}})],session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.sub,e.user.role=t.role),e)},pages:{signIn:"/auth/signin"}};r()(o)},8925:(e,t,s)=>{"use strict";s.d(t,{prisma:()=>r});let a=require("@prisma/client"),r=globalThis.prisma??new a.PrismaClient({log:["query"]})},6764:()=>{},3227:e=>{"use strict";e.exports=require("next-auth")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[899,342,664],()=>s(8381));module.exports=a})();