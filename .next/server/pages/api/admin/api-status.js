"use strict";(()=>{var e={};e.id=2747,e.ids=[2747],e.modules={8432:e=>{e.exports=require("bcryptjs")},3227:e=>{e.exports=require("next-auth")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},7886:(e,t,a)=>{a.r(t),a.d(t,{config:()=>p,default:()=>c,routeModule:()=>h});var r={};a.r(r),a.d(r,{default:()=>m});var n=a(1802),s=a(7153),i=a(6249),o=a(3227),l=a(3515),u=a(8438);async function m(e,t){try{let a=await (0,o.getServerSession)(e,t,l.authOptions);if(!a||a.user?.role!=="ADMIN")return t.status(401).json({success:!1,error:"Unauthorized"});if("GET"!==e.method)return t.status(405).json({success:!1,error:"Method not allowed"});let r=await d();return t.status(200).json({success:!0,data:r})}catch(e){return console.error("API status error:",e),t.status(500).json({success:!1,error:"Internal server error"})}}async function d(){let e=Date.now(),t=[{name:"Authentication",path:"/api/auth/session",category:"Auth"},{name:"User Management",path:"/api/admin/users",category:"Admin"},{name:"Event Management",path:"/api/admin/events",category:"Admin"},{name:"Health Check",path:"/api/admin/health",category:"System"},{name:"System Operations",path:"/api/admin/system-ops",category:"System"},{name:"Audit Logs",path:"/api/admin/audit-logs",category:"System"},{name:"Email Configuration",path:"/api/admin/email-config",category:"Config"}],a=await Promise.all(t.map(async e=>{let t=Date.now(),a="healthy",r=0,n=null;try{r=200*Math.random()+50,e.path.includes("email-config")&&(r=1e3*Math.random()+200)>800&&(a="warning"),.05>Math.random()&&(a="error",n="Connection timeout")}catch(e){a="error",n=e instanceof Error?e.message:"Unknown error",r=Date.now()-t}return{...e,status:a,responseTime:Math.round(r),error:n,lastChecked:new Date().toISOString()}})),r="healthy",n=0,s=null;try{let e=Date.now();await u._.$queryRaw`SELECT 1`,(n=Date.now()-e)>1e3&&(r="warning"),n>3e3&&(r="error")}catch(e){r="error",s=e instanceof Error?e.message:"Database connection failed"}let i=a.filter(e=>"healthy"===e.status).length,o=a.filter(e=>"warning"===e.status).length,l=a.filter(e=>"error"===e.status).length,m="healthy";return l>0||"error"===r?m="error":(o>0||"warning"===r)&&(m="warning"),{overall:{status:m,totalEndpoints:t.length,healthy:i,warning:o,error:l,responseTime:Date.now()-e,timestamp:new Date().toISOString()},database:{status:r,responseTime:n,error:s},endpoints:a,categories:{Auth:a.filter(e=>"Auth"===e.category),Admin:a.filter(e=>"Admin"===e.category),System:a.filter(e=>"System"===e.category),Config:a.filter(e=>"Config"===e.category)},metrics:{averageResponseTime:Math.round(a.reduce((e,t)=>e+t.responseTime,0)/a.length),uptime:process.uptime(),requestsHandled:Math.floor(1e4*Math.random()),errorsInLastHour:l}}}let c=(0,i.l)(r,"default"),p=(0,i.l)(r,"config"),h=new n.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/admin/api-status",pathname:"/api/admin/api-status",bundlePath:"",filename:""},userland:r})},3515:(e,t,a)=>{a.r(t),a.d(t,{authOptions:()=>m,default:()=>d});var r=a(3227),n=a.n(r);let s=require("next-auth/providers/credentials");var i=a.n(s),o=a(8438),l=a(8432),u=a.n(l);let m={providers:[i()({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await o._.users.findUnique({where:{email:e.email}});return t&&t.passwordHash&&await u().compare(e.password,t.passwordHash)?{id:t.id,email:t.email,name:`${t.firstName} ${t.lastName}`,image:t.image||null,role:t.role}:null}})],session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role,e.image=t.image),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.sub,e.user.role=t.role),e)},pages:{signIn:"/auth/signin"}},d=n()(m)},8438:(e,t,a)=>{a.d(t,{_:()=>n});let r=require("@prisma/client"),n=globalThis.prisma??new r.PrismaClient},7153:(e,t)=>{var a;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))},1802:(e,t,a)=>{e.exports=a(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var a=t(t.s=7886);module.exports=a})();