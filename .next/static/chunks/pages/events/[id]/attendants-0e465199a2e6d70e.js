(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[199],{9781:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/events/[id]/attendants",function(){return s(4535)}])},5083:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var a=s(5893),r=s(3299),l=s(1664),n=s.n(l),i=s(1163);function d(e){var t;let{children:s,title:l="JW Attendant Scheduler",breadcrumbs:d=[],selectedEvent:o}=e,{data:c}=(0,r.useSession)(),m=(0,i.useRouter)(),x=[{label:"Events",href:"/events",icon:"\uD83D\uDCC5",roles:["ADMIN","OVERSEER","ATTENDANT"]},{label:"Event Selection",href:"/events/select",icon:"\uD83C\uDFAF",roles:["ADMIN","OVERSEER","ATTENDANT"]}];(null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.role)==="ADMIN"&&x.push({label:"Admin Portal",href:"/admin",icon:"\uD83D\uDEE1️",roles:["ADMIN"]});let u=x.filter(e=>{var t;return e.roles.includes((null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.role)||"")});return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)(n(),{href:"/events/select",className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:"\uD83D\uDCCB"}),(0,a.jsx)("span",{className:"ml-2 text-xl font-semibold text-gray-900",children:"JW Attendant Scheduler"})]}),(0,a.jsx)("div",{className:"hidden md:ml-8 md:flex md:space-x-4",children:u.map(e=>(0,a.jsxs)(n(),{href:e.href,className:"px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat(m.pathname.startsWith(e.href)?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.href))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[o&&(0,a.jsxs)("div",{className:"hidden md:flex items-center bg-blue-50 px-3 py-1 rounded-lg",children:[(0,a.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["\uD83D\uDCC5 ",o.name]}),o.status&&(0,a.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full ".concat("current"===o.status?"bg-green-100 text-green-800":"upcoming"===o.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:o.status})]}),(null==c?void 0:c.user)&&(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-sm text-gray-700",children:c.user.name}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("ADMIN"===c.user.role?"bg-red-100 text-red-800":"OVERSEER"===c.user.role?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:c.user.role}),(0,a.jsx)("button",{onClick:()=>{(0,r.signOut)({callbackUrl:"/auth/signin"})},className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"Sign Out"})]})]})]})})}),d.length>0&&(0,a.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:(0,a.jsx)("nav",{className:"flex","aria-label":"Breadcrumb",children:(0,a.jsx)("ol",{className:"flex items-center space-x-2",children:d.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center",children:[t>0&&(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-400 mx-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.href?(0,a.jsx)(n(),{href:e.href,className:"text-sm text-blue-600 hover:text-blue-800",children:e.label}):(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.label})]},t))})})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l&&(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:l})}),s]})]})}},4535:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return i},default:function(){return d}});var a=s(5893),r=s(5083),l=s(7294),n=s(1163),i=!0;function d(e){let{eventId:t,event:s,attendants:i,stats:d}=e,o=(0,n.useRouter)(),[c,m]=(0,l.useState)(!1),[x,u]=(0,l.useState)(!1),[h,g]=(0,l.useState)(!1),[b,p]=(0,l.useState)(null),[f,v]=(0,l.useState)(null),[y,j]=(0,l.useState)(new Set),[N,w]=(0,l.useState)({isActive:"",congregation:"",formsOfService:"",overseerId:null,keymanId:null}),[k,C]=(0,l.useState)({search:"",congregation:"",isActive:"all"}),[A,S]=(0,l.useState)(1),[O,E]=(0,l.useState)(!1),[I,D]=(0,l.useState)(null),L=i.filter(e=>{let t=""===k.search||e.firstName.toLowerCase().includes(k.search.toLowerCase())||e.lastName.toLowerCase().includes(k.search.toLowerCase())||e.email.toLowerCase().includes(k.search.toLowerCase()),s=""===k.congregation||e.congregation&&e.congregation.toLowerCase().includes(k.congregation.toLowerCase()),a="all"===k.isActive||"true"===k.isActive&&e.isActive||"false"===k.isActive&&!e.isActive;return t&&s&&a}),T=Math.ceil(L.length/20),R=(A-1)*20,F=L.slice(R,R+20),[M,P]=(0,l.useState)({firstName:"",lastName:"",email:"",phone:"",congregation:"",formsOfService:"",notes:"",isActive:!0}),U=()=>{P({firstName:"",lastName:"",email:"",phone:"",congregation:"",formsOfService:"",notes:"",isActive:!0}),p(null),m(!0)},_=e=>{P({firstName:e.firstName,lastName:e.lastName,email:e.email,phone:e.phone||"",congregation:e.congregation||"",formsOfService:Array.isArray(e.formsOfService)?e.formsOfService.join(", "):e.formsOfService||"",notes:"",isActive:e.isActive}),p(e),m(!0)},V=async e=>{e.preventDefault(),E(!0);try{let e=b?"/api/events/".concat(t,"/attendants/").concat(b.associationId):"/api/events/".concat(t,"/attendants"),s=await fetch(e,{method:b?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(s.ok)m(!1),o.reload();else{let e=await s.json();alert(e.error||"Failed to save attendant")}}catch(e){console.error("Error saving attendant:",e),alert("Failed to save attendant")}finally{E(!1)}},z=async e=>{if(confirm("Are you sure you want to remove ".concat(e.firstName," ").concat(e.lastName,"?"))){E(!0);try{let s=await fetch("/api/events/".concat(t,"/attendants/").concat(e.associationId),{method:"DELETE"});if(s.ok)o.reload();else{let e=await s.json();alert(e.error||"Failed to remove attendant")}}catch(e){console.error("Error removing attendant:",e),alert("Failed to remove attendant")}finally{E(!1)}}},J=async()=>{if(f){E(!0);try{let e=(await f.text()).split("\n").filter(e=>e.trim());if(e.length<2){alert("CSV file must have at least a header row and one data row");return}let s=e[0].split(",").map(e=>e.trim().replace(/"/g,"")),a=[];for(let t=1;t<e.length;t++){let r=e[t].split(",").map(e=>e.trim().replace(/"/g,"")),l={};s.forEach((e,t)=>{let s=r[t]||"";switch(e.toLowerCase()){case"firstname":l.firstName=s;break;case"lastname":l.lastName=s;break;case"email":l.email=s;break;case"phone":l.phone=s;break;case"congregation":l.congregation=s;break;case"formsofservice":l.formsOfService=s;break;case"notes":l.notes=s;break;case"isactive":l.isActive="true"===s.toLowerCase()}}),l.firstName&&l.lastName&&l.email&&a.push(l)}if(0===a.length){alert("No valid attendant records found in CSV");return}let r=await fetch("/api/events/".concat(t,"/attendants"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({attendants:a})}),l=await r.json();l.success?(D(l.data),u(!1),o.reload(),alert("Successfully imported ".concat(a.length," attendants"))):alert("Import failed: ".concat(l.error))}catch(e){console.error("Import error:",e),alert("Failed to parse CSV file. Please check the format.")}finally{E(!1)}}},B=e=>{let t=new Set(y);t.has(e)?t.delete(e):t.add(e),j(t)},K=async()=>{if(0!==y.size){E(!0);try{let e=[],s=[];for(let a of y){let r={};""!==N.isActive&&(r.isActive="true"===N.isActive),""!==N.congregation&&(r.congregation=N.congregation),""!==N.formsOfService&&(r.formsOfService=N.formsOfService),Object.keys(r).length>0&&e.push(fetch("/api/events/".concat(t,"/attendants/").concat(a),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}));let l={};if(null!==N.overseerId&&(l.overseerId="REMOVE"===N.overseerId?null:N.overseerId),null!==N.keymanId&&(l.keymanId="REMOVE"===N.keymanId?null:N.keymanId),Object.keys(l).length>0){let e=i.find(e=>e.associationId===a);e&&s.push(fetch("/api/events/".concat(t,"/attendants/").concat(e.id,"/leadership"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}))}}await Promise.all([...e,...s]),g(!1),j(new Set),w({isActive:"",formsOfService:"",congregation:"",overseerId:null,keymanId:null}),o.reload()}catch(e){console.error("Bulk edit error:",e),alert("Failed to update attendants")}finally{E(!1)}}};return(0,a.jsx)(r.Z,{title:"".concat(s.name," - Attendants | JW Attendant Scheduler"),breadcrumbs:[{label:"Events",href:"/events"},{label:s.name,href:"/events/".concat(t)},{label:"Attendants"}],selectedEvent:{id:t,name:s.name,status:s.status},children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Event Attendants"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Manage attendants for ",s.name]})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:()=>o.push("/events/".concat(t)),className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded transition-colors",children:"← Back to Event"}),(0,a.jsx)("button",{onClick:U,disabled:O,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-bold py-2 px-4 rounded transition-colors",children:"➕ Add Attendant"}),(0,a.jsx)("button",{onClick:()=>{u(!0),v(null),D(null)},disabled:O,className:"bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white font-bold py-2 px-4 rounded transition-colors",children:"\uD83D\uDCE5 Import Attendants"}),y.size>0&&(0,a.jsxs)("button",{onClick:()=>{if(0===y.size){alert("Please select attendants to edit");return}g(!0)},disabled:O,className:"bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white font-bold py-2 px-4 rounded transition-colors",children:["✏️ Bulk Edit (",y.size,")"]})]})]})}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:k.search,onChange:e=>C({...k,search:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Congregation"}),(0,a.jsx)("input",{type:"text",placeholder:"Filter by congregation...",value:k.congregation,onChange:e=>C({...k,congregation:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,a.jsxs)("select",{value:k.isActive,onChange:e=>C({...k,isActive:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All"}),(0,a.jsx)("option",{value:"true",children:"Active"}),(0,a.jsx)("option",{value:"false",children:"Inactive"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:()=>C({search:"",congregation:"",isActive:"all"}),className:"w-full bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition-colors",children:"Clear Filters"})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,a.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,a.jsx)("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold",children:d.total})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Attendants"}),(0,a.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:d.total})]})})]})})}),(0,a.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,a.jsx)("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold",children:d.active})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active"}),(0,a.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:d.active})]})})]})})}),(0,a.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,a.jsx)("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold",children:d.inactive})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Inactive"}),(0,a.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:d.inactive})]})})]})})})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Attendants List"}),0===i.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"No attendants found for this event"}),(0,a.jsx)("button",{onClick:U,disabled:O,className:"mt-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-bold py-2 px-4 rounded transition-colors",children:"Add First Attendant"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,a.jsx)("input",{type:"checkbox",checked:y.size===i.length&&i.length>0,onChange:()=>{y.size===i.length?j(new Set):j(new Set(i.map(e=>e.associationId)))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Congregation"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Forms of Service"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Overseer"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Keyman"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("input",{type:"checkbox",checked:y.has(e.associationId),onChange:()=>B(e.associationId),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.firstName," ",e.lastName]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.email})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.congregation||"N/A"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:(Array.isArray(e.formsOfService)?e.formsOfService:(e.formsOfService||"").toString().split(", ").filter(e=>e.trim())).map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("Overseer"===e?"bg-purple-100 text-purple-800":"Keyman"===e?"bg-blue-100 text-blue-800":"Elder"===e?"bg-yellow-100 text-yellow-800":"Ministerial Servant"===e?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e},t))})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("select",{value:e.overseerId||"",onChange:async s=>{let a=s.target.value||null;try{(await fetch("/api/events/".concat(t,"/attendants/").concat(e.id,"/leadership"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({overseerId:a})})).ok?o.reload():alert("Failed to update overseer")}catch(e){console.error("Error updating overseer:",e),alert("Failed to update overseer")}},className:"text-sm border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"No Overseer"}),i.filter(e=>e.isActive&&Array.isArray(e.formsOfService)&&e.formsOfService.some(e=>e.toLowerCase().includes("overseer"))).map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("select",{value:e.keymanId||"",onChange:async s=>{let a=s.target.value||null;try{(await fetch("/api/events/".concat(t,"/attendants/").concat(e.id,"/leadership"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({keymanId:a})})).ok?o.reload():alert("Failed to update keyman")}catch(e){console.error("Error updating keyman:",e),alert("Failed to update keyman")}},className:"text-sm border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"No Keyman"}),i.filter(e=>e.isActive&&Array.isArray(e.formsOfService)&&e.formsOfService.some(e=>e.toLowerCase().includes("keyman"))).map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Inactive"})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,a.jsx)("button",{onClick:()=>_(e),disabled:O,className:"text-blue-600 hover:text-blue-900 disabled:text-blue-400 mr-3",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>z(e),disabled:O,className:"text-red-600 hover:text-red-900 disabled:text-red-400",children:"Remove"})]})]},e.id))})]})})]}),T>1&&(0,a.jsxs)("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[(0,a.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,a.jsx)("button",{onClick:()=>S(Math.max(1,A-1)),disabled:1===A,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>S(Math.min(T,A+1)),disabled:A===T,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400",children:"Next"})]}),(0,a.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing ",(0,a.jsx)("span",{className:"font-medium",children:R+1})," to"," ",(0,a.jsx)("span",{className:"font-medium",children:Math.min(R+20,L.length)})," of"," ",(0,a.jsx)("span",{className:"font-medium",children:L.length})," results"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[(0,a.jsx)("button",{onClick:()=>S(Math.max(1,A-1)),disabled:1===A,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400",children:"Previous"}),Array.from({length:T},(e,t)=>t+1).map(e=>(0,a.jsx)("button",{onClick:()=>S(e),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(e===A?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:e},e)),(0,a.jsx)("button",{onClick:()=>S(Math.min(T,A+1)),disabled:A===T,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400",children:"Next"})]})})]})]})]}),c&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:b?"Edit Attendant":"Add New Attendant"}),(0,a.jsxs)("form",{onSubmit:V,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"First Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:M.firstName,onChange:e=>P({...M,firstName:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:M.lastName,onChange:e=>P({...M,lastName:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email *"}),(0,a.jsx)("input",{type:"email",required:!0,value:M.email,onChange:e=>P({...M,email:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,a.jsx)("input",{type:"tel",value:M.phone,onChange:e=>P({...M,phone:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Congregation"}),(0,a.jsx)("input",{type:"text",value:M.congregation,onChange:e=>P({...M,congregation:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter congregation name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Forms of Service *"}),(0,a.jsx)("div",{className:"mt-2 space-y-2",children:["Elder","Ministerial Servant","Regular Pioneer","Overseer","Keyman","Other Dept."].map(e=>(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:M.formsOfService.split(", ").filter(e=>e.trim()).includes(e),onChange:t=>{let s=M.formsOfService.split(", ").filter(e=>e.trim());t.target.checked?P({...M,formsOfService:[...s,e].join(", ")}):P({...M,formsOfService:s.filter(t=>t!==e).join(", ")})},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:e})]},e))}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Select all applicable forms of service. Overseers manage Keymen and Attendants. Keymen manage groups of Attendants."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),(0,a.jsx)("textarea",{value:M.notes,onChange:e=>P({...M,notes:e.target.value}),rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Additional notes or comments"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:!1!==M.isActive,onChange:e=>P({...M,isActive:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Active Attendant"})]}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Inactive attendants will not be available for new assignments"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>m(!1),disabled:O,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:bg-gray-100",children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",disabled:O,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-md",children:[O?"Saving...":b?"Update":"Add"," Attendant"]})]})]})]})})}),x&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Import Attendants"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Upload a CSV file with attendant information."}),(0,a.jsx)("button",{onClick:()=>{let e=new Blob(['firstName,lastName,email,phone,congregation,formsOfService,notes,isActive\nJohn,Doe,john.doe@example.com,555-1234,Central Congregation,"Elder, Overseer",,true\nJane,Smith,jane.smith@example.com,555-5678,North Congregation,"Ministerial Servant, Keyman",,true\nBob,Johnson,bob.johnson@example.com,,South Congregation,"Regular Pioneer",,true'],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="attendants-import-template.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(t)},className:"text-blue-600 hover:text-blue-800 text-sm underline",children:"\uD83D\uDCE5 Download CSV Template"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select CSV File"}),(0,a.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&"text/csv"===s.type?v(s):alert("Please select a valid CSV file")},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),f&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded",children:(0,a.jsxs)("p",{className:"text-sm text-green-800",children:["✅ File selected: ",f.name]})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>u(!1),disabled:O,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:bg-gray-100",children:"Cancel"}),(0,a.jsx)("button",{onClick:J,disabled:O||!f,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white rounded-md",children:O?"Importing...":"Import Attendants"})]})]})})}),h&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Bulk Edit ",y.size," Attendants"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,a.jsxs)("select",{value:N.isActive,onChange:e=>w({...N,isActive:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"No Change"}),(0,a.jsx)("option",{value:"true",children:"Active"}),(0,a.jsx)("option",{value:"false",children:"Inactive"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Congregation"}),(0,a.jsx)("input",{type:"text",value:N.congregation,onChange:e=>w({...N,congregation:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Leave empty for no change"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Forms of Service (comma-separated)"}),(0,a.jsx)("input",{type:"text",value:N.formsOfService,onChange:e=>w({...N,formsOfService:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Elder, Overseer (leave empty for no change)"})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Leadership Assignment"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign Overseer"}),(0,a.jsxs)("select",{value:N.overseerId||"",onChange:e=>w({...N,overseerId:e.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,a.jsx)("option",{value:"",children:"No change"}),(0,a.jsx)("option",{value:"REMOVE",children:"Remove overseer"}),i.filter(e=>e.isActive&&Array.isArray(e.formsOfService)&&e.formsOfService.some(e=>e.toLowerCase().includes("overseer"))).map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign Keyman"}),(0,a.jsxs)("select",{value:N.keymanId||"",onChange:e=>w({...N,keymanId:e.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,a.jsx)("option",{value:"",children:"No change"}),(0,a.jsx)("option",{value:"REMOVE",children:"Remove keyman"}),i.filter(e=>e.isActive&&Array.isArray(e.formsOfService)&&e.formsOfService.some(e=>e.toLowerCase().includes("keyman"))).map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]})]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>g(!1),disabled:O,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:bg-gray-100",children:"Cancel"}),(0,a.jsx)("button",{onClick:K,disabled:O,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white rounded-md",children:O?"Updating...":"Update Attendants"})]})]})})})]})})}}},function(e){e.O(0,[424,888,774,179],function(){return e(e.s=9781)}),_N_E=e.O()}]);