(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[199],{9781:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/events/[id]/attendants",function(){return s(7005)}])},5083:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});var r=s(5893),a=s(3299),n=s(1664),l=s.n(n),i=s(1163);function c(e){var t;let{children:s,title:n="JW Attendant Scheduler",breadcrumbs:c=[],selectedEvent:o}=e,{data:d}=(0,a.useSession)(),m=(0,i.useRouter)(),x=[{label:"Events",href:"/events",icon:"\uD83D\uDCC5",roles:["ADMIN","OVERSEER","ATTENDANT"]},{label:"Event Selection",href:"/events/select",icon:"\uD83C\uDFAF",roles:["ADMIN","OVERSEER","ATTENDANT"]}];(null==d?void 0:null===(t=d.user)||void 0===t?void 0:t.role)==="ADMIN"&&x.push({label:"Admin Portal",href:"/admin",icon:"\uD83D\uDEE1ï¸",roles:["ADMIN"]});let u=x.filter(e=>{var t;return e.roles.includes((null==d?void 0:null===(t=d.user)||void 0===t?void 0:t.role)||"")});return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)(l(),{href:"/events/select",className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:"\uD83D\uDCCB"}),(0,r.jsx)("span",{className:"ml-2 text-xl font-semibold text-gray-900",children:"JW Attendant Scheduler"})]}),(0,r.jsx)("div",{className:"hidden md:ml-8 md:flex md:space-x-4",children:u.map(e=>(0,r.jsxs)(l(),{href:e.href,className:"px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat(m.pathname.startsWith(e.href)?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[(0,r.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.href))})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[o&&(0,r.jsxs)("div",{className:"hidden md:flex items-center bg-blue-50 px-3 py-1 rounded-lg",children:[(0,r.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["\uD83D\uDCC5 ",o.name]}),o.status&&(0,r.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full ".concat("current"===o.status?"bg-green-100 text-green-800":"upcoming"===o.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:o.status})]}),(null==d?void 0:d.user)&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("span",{className:"text-sm text-gray-700",children:d.user.name}),(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("ADMIN"===d.user.role?"bg-red-100 text-red-800":"OVERSEER"===d.user.role?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:d.user.role}),(0,r.jsx)("button",{onClick:()=>{(0,a.signOut)({callbackUrl:"/auth/signin"})},className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"Sign Out"})]})]})]})})}),c.length>0&&(0,r.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:(0,r.jsx)("nav",{className:"flex","aria-label":"Breadcrumb",children:(0,r.jsx)("ol",{className:"flex items-center space-x-2",children:c.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center",children:[t>0&&(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400 mx-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.href?(0,r.jsx)(l(),{href:e.href,className:"text-sm text-blue-600 hover:text-blue-800",children:e.label}):(0,r.jsx)("span",{className:"text-sm text-gray-500",children:e.label})]},t))})})})}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n&&(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:n})}),s]})]})}},7005:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return O},default:function(){return I}});var r=s(5893),a=s(7294),n=s(1163),l=s(3299),i=s(9008),c=s.n(i),o=s(1664),d=s.n(o);class m{getBaseUrl(e){return"/api/events/".concat(e,"/attendants")}async getEventAttendants(e,t){var s;let r=new URLSearchParams;(null==t?void 0:t.page)&&r.append("page",t.page.toString()),(null==t?void 0:t.limit)&&r.append("limit",t.limit.toString()),(null==t?void 0:t.search)&&r.append("search",t.search),(null==t?void 0:t.congregation)&&r.append("congregation",t.congregation),(null==t?void 0:null===(s=t.formsOfService)||void 0===s?void 0:s.length)&&r.append("formsOfService",t.formsOfService.join(",")),(null==t?void 0:t.isActive)!==void 0&&r.append("isActive",t.isActive.toString()),(null==t?void 0:t.hasUser)!==void 0&&r.append("hasUser",t.hasUser.toString()),(null==t?void 0:t.includeStats)&&r.append("includeStats","true");let a=await fetch("".concat(this.getBaseUrl(e),"?").concat(r));if(!a.ok)throw Error("Failed to fetch event attendants: ".concat(a.statusText));return a.json()}async getEventAttendant(e,t){let s=await fetch("".concat(this.getBaseUrl(e),"/").concat(t));if(!s.ok)throw Error("Failed to fetch event attendant: ".concat(s.statusText));return s.json()}async createEventAttendant(e,t){let s=await fetch(this.getBaseUrl(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw Error((await s.json()).error||"Failed to create event attendant (".concat(s.status,": ").concat(s.statusText,")"));return s.json()}async updateEventAttendant(e,t,s){let r=await fetch("".concat(this.getBaseUrl(e),"/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok)throw Error((await r.json()).error||"Failed to update event attendant (".concat(r.status,": ").concat(r.statusText,")"));return r.json()}async deleteEventAttendant(e,t){let s=await fetch("".concat(this.getBaseUrl(e),"/").concat(t),{method:"DELETE"});if(!s.ok)throw Error((await s.json()).error||"Failed to delete event attendant (".concat(s.status,": ").concat(s.statusText,")"));return s.json()}async bulkImportEventAttendants(e,t){let s=await fetch(this.getBaseUrl(e),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!s.ok){let e=await s.json();throw console.error("Bulk import error:",e),Error(e.error||"Failed to import event attendants (".concat(s.status,": ").concat(s.statusText,")"))}return s.json()}async bulkUpdateEventAttendantStatus(e,t,s){return{success:!0}}async bulkDeleteEventAttendants(e,t){let s=t.map(t=>this.deleteEventAttendant(e,t));try{return await Promise.all(s),{success:!0}}catch(e){throw Error("Failed to bulk delete attendants: ".concat(e instanceof Error?e.message:"Unknown error"))}}}let x=new m;function u(e){let{value:t,onChange:s,placeholder:a="Search attendants...",disabled:n=!1,className:l=""}=e;return(0,r.jsxs)("div",{className:"relative ".concat(l),children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,r.jsx)("input",{type:"text",value:t,onChange:e=>s(e.target.value),placeholder:a,disabled:n,className:"\n          block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md\n          placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n          ".concat(n?"bg-gray-100 cursor-not-allowed":"bg-white","\n          sm:text-sm\n        ")})]})}let h=["Elder","Ministerial Servant","Exemplary","Regular Pioneer","Other Department"];function g(e){let{selectedForms:t,onChange:s,disabled:n=!1,className:l="",label:i="Forms of Service",required:c=!1}=e,[o,d]=(0,a.useState)(!1),m=e=>{t.includes(e)?s(t.filter(t=>t!==e)):s([...t,e])};return(0,r.jsxs)("div",{className:"relative ".concat(l),children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i,c&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{type:"button",onClick:()=>d(!o),disabled:n,className:"\n            w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-left\n            focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n            ".concat(n?"bg-gray-100 cursor-not-allowed":"hover:border-gray-400 cursor-pointer","\n            ").concat(0===t.length?"text-gray-500":"text-gray-900","\n          "),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"block truncate",children:0===t.length?"Select forms of service...":1===t.length?t[0]:"".concat(t.length," forms selected")}),(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400 transition-transform ".concat(o?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),o&&(0,r.jsx)("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg",children:(0,r.jsxs)("div",{className:"py-1",children:[(0,r.jsx)("div",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{s(h)},className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Select All"}),(0,r.jsx)("button",{type:"button",onClick:()=>{s([])},className:"text-xs text-gray-600 hover:text-gray-800 font-medium",children:"Clear All"})]})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:h.map(e=>(0,r.jsxs)("label",{className:"flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:t.includes(e),onChange:()=>m(e),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-900",children:e})]},e))})]})})]}),t.length>0&&(0,r.jsx)("div",{className:"mt-2 flex flex-wrap gap-1",children:t.map(e=>(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:[e,(0,r.jsx)("button",{type:"button",onClick:()=>m(e),className:"ml-1 h-3 w-3 rounded-full hover:bg-blue-200 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"h-2 w-2",fill:"currentColor",viewBox:"0 0 8 8",children:(0,r.jsx)("path",{d:"M1.41 0l-1.41 1.41.72.72 1.78 1.81-1.78 1.81-.72.72 1.41 1.41.72-.72 1.81-1.78 1.81 1.78.72.72 1.41-1.41-.72-.72-1.78-1.81 1.78-1.81.72-.72-1.41-1.41-.72.72-1.81 1.78-1.81-1.78-.72-.72z"})})})]},e))}),o&&(0,r.jsx)("div",{className:"fixed inset-0 z-0",onClick:()=>d(!1)})]})}function p(e){var t;let{filters:s,onFiltersChange:a,congregations:n,loading:l=!1}=e,i=e=>{a({...s,search:e})},c=e=>{a({...s,congregation:e})},o=e=>{a({...s,isActive:e})},d=e=>{a({...s,hasUser:e})},m=!!(s.search||s.congregation||(null===(t=s.formsOfService)||void 0===t?void 0:t.length)||void 0!==s.isActive||void 0!==s.hasUser);return(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"}),m&&(0,r.jsx)("button",{onClick:()=>{a({})},disabled:l,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Clear All"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"lg:col-span-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,r.jsx)(u,{value:s.search||"",onChange:i,placeholder:"Search by name, email, or congregation...",disabled:l})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Congregation"}),(0,r.jsxs)("select",{value:s.congregation||"",onChange:e=>c(e.target.value),disabled:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,r.jsx)("option",{value:"",children:"All Congregations"}),n.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{value:void 0===s.isActive?"":s.isActive.toString(),onChange:e=>{let t=e.target.value;o(""===t?void 0:"true"===t)},disabled:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,r.jsx)("option",{value:"",children:"All Status"}),(0,r.jsx)("option",{value:"true",children:"Active"}),(0,r.jsx)("option",{value:"false",children:"Inactive"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Account"}),(0,r.jsxs)("select",{value:void 0===s.hasUser?"":s.hasUser.toString(),onChange:e=>{let t=e.target.value;d(""===t?void 0:"true"===t)},disabled:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,r.jsx)("option",{value:"",children:"All Users"}),(0,r.jsx)("option",{value:"true",children:"Has Account"}),(0,r.jsx)("option",{value:"false",children:"No Account"})]})]})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(g,{selectedForms:s.formsOfService||[],onChange:e=>{a({...s,formsOfService:e})},disabled:l,label:"Filter by Forms of Service"})}),m&&(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[s.search&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:['Search: "',s.search,'"',(0,r.jsx)("button",{onClick:()=>i(""),className:"ml-1 h-3 w-3 rounded-full hover:bg-blue-200 flex items-center justify-center",children:"\xd7"})]}),s.congregation&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-green-100 text-green-800",children:["Congregation: ",s.congregation,(0,r.jsx)("button",{onClick:()=>c(""),className:"ml-1 h-3 w-3 rounded-full hover:bg-green-200 flex items-center justify-center",children:"\xd7"})]}),void 0!==s.isActive&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-yellow-100 text-yellow-800",children:["Status: ",s.isActive?"Active":"Inactive",(0,r.jsx)("button",{onClick:()=>o(void 0),className:"ml-1 h-3 w-3 rounded-full hover:bg-yellow-200 flex items-center justify-center",children:"\xd7"})]})]})})]})}function f(e){let{isActive:t,className:s=""}=e;return(0,r.jsx)("span",{className:"\n        inline-flex px-2 py-1 text-xs font-semibold rounded-full\n        ".concat(t?"bg-green-100 text-green-800":"bg-red-100 text-red-800","\n        ").concat(s,"\n      "),children:t?"Active":"Inactive"})}h.map(e=>({value:e,label:e}));let v={Elder:"bg-purple-100 text-purple-800","Ministerial Servant":"bg-blue-100 text-blue-800",Exemplary:"bg-green-100 text-green-800","Regular Pioneer":"bg-yellow-100 text-yellow-800","Other Department":"bg-gray-100 text-gray-800"},j={Elder:"Elder","Ministerial Servant":"MS",Exemplary:"Exemplary","Regular Pioneer":"RP","Other Department":"Other"};function b(e){let{form:t,className:s="",size:a="sm"}=e;return(0,r.jsx)("span",{className:"\n        inline-flex font-medium rounded-full\n        ".concat(v[t],"\n        ").concat("sm"===a?"px-2 py-1 text-xs":"px-3 py-1 text-sm","\n        ").concat(s,"\n      "),title:t,children:j[t]})}let N={primary:"bg-blue-600 hover:bg-blue-700 text-white border-transparent",secondary:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",danger:"bg-red-600 hover:bg-red-700 text-white border-transparent",success:"bg-green-600 hover:bg-green-700 text-white border-transparent"},y={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};function w(e){let{onClick:t,variant:s="primary",size:a="md",disabled:n=!1,loading:l=!1,children:i,className:c="",type:o="button"}=e;return(0,r.jsxs)("button",{type:o,onClick:e=>{"button"===o&&e.preventDefault(),t(e)},disabled:n||l,className:"\n        inline-flex items-center justify-center\n        border rounded-md font-medium\n        focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\n        transition-colors duration-200\n        ".concat(N[s],"\n        ").concat(y[a],"\n        ").concat(n||l?"opacity-50 cursor-not-allowed":"cursor-pointer","\n        ").concat(c,"\n      "),children:[l&&(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i]})}function k(e){let{attendants:t,loading:s=!1,onEdit:n,onDelete:l,onSelect:i,selectedIds:c=[],onBulkStatusChange:o}=e,[d,m]=(0,a.useState)("lastName"),[x,u]=(0,a.useState)("asc"),h=e=>{d===e?u("asc"===x?"desc":"asc"):(m(e),u("asc"))},g=e=>{i&&i(e?t.map(e=>e.id):[])},p=(e,t)=>{i&&(t?i([...c,e]):i(c.filter(t=>t!==e)))},v=[...t].sort((e,t)=>{let s=e[d],r=t[d];if(null==s)return 1;if(null==r)return -1;let a=s<r?-1:s>r?1:0;return"asc"===x?a:-a}),j=e=>{let{field:t}=e;return d!==t?(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):"asc"===x?(0,r.jsx)("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):(0,r.jsx)("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})},N=t.length>0&&c.length===t.length,y=c.length>0&&c.length<t.length;return s?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsxs)("div",{className:"px-6 py-12 text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading attendants..."})]})}):0===t.length?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsx)("div",{className:"px-6 py-12 text-center text-gray-500",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("svg",{className:"w-12 h-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,r.jsx)("p",{className:"text-lg font-medium",children:"No attendants found"}),(0,r.jsx)("p",{className:"text-sm",children:"Try adjusting your filters or create a new attendant"})]})})}):(0,r.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[i&&(0,r.jsx)("th",{className:"px-3 py-3 text-left w-12",children:(0,r.jsx)("input",{type:"checkbox",checked:N,ref:e=>{e&&(e.indeterminate=y)},onChange:e=>g(e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,r.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[15%]",onClick:()=>h("lastName"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Name"}),(0,r.jsx)(j,{field:"lastName"})]})}),(0,r.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[20%]",onClick:()=>h("email"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Email"}),(0,r.jsx)(j,{field:"email"})]})}),(0,r.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[10%]",children:"Phone"}),(0,r.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[12%]",onClick:()=>h("congregation"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Congregation"}),(0,r.jsx)(j,{field:"congregation"})]})}),(0,r.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[15%]",children:"Forms of Service"}),(0,r.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-[8%]",onClick:()=>h("isActive"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Status"}),(0,r.jsx)(j,{field:"isActive"})]})}),(0,r.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[10%]",children:"User Account"}),(0,r.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-[10%]",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(e=>{var t,s;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[i&&(0,r.jsx)("td",{className:"px-2 py-3",children:(0,r.jsx)("input",{type:"checkbox",checked:c.includes(e.id),onChange:t=>p(e.id,t.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,r.jsx)("td",{className:"px-2 py-3",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 h-6 w-6",children:(0,r.jsx)("div",{className:"h-6 w-6 rounded-full bg-blue-100 flex items-center justify-center",children:(0,r.jsxs)("span",{className:"text-blue-600 font-medium text-xs",children:[e.firstName[0],e.lastName[0]]})})}),(0,r.jsx)("div",{className:"ml-2 truncate",children:(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900 truncate",children:[e.firstName," ",e.lastName]})})]})}),(0,r.jsx)("td",{className:"px-2 py-3 text-sm text-gray-500",children:(0,r.jsx)("div",{className:"truncate",title:e.email,children:e.email})}),(0,r.jsx)("td",{className:"px-2 py-3 text-sm text-gray-500",children:(0,r.jsx)("div",{className:"truncate",children:e.phone||"N/A"})}),(0,r.jsx)("td",{className:"px-2 py-3 text-sm text-gray-500",children:(0,r.jsx)("div",{className:"truncate",title:e.congregation,children:e.congregation})}),(0,r.jsx)("td",{className:"px-2 py-3",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[null===(t=e.formsOfService)||void 0===t?void 0:t.slice(0,2).map((e,t)=>(0,r.jsx)(b,{form:e},t)),(null===(s=e.formsOfService)||void 0===s?void 0:s.length)>2&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.formsOfService.length-2]})]})}),(0,r.jsx)("td",{className:"px-2 py-3",children:(0,r.jsx)(f,{isActive:e.isActive})}),(0,r.jsx)("td",{className:"px-2 py-3 text-sm text-gray-500",children:e.users?(0,r.jsx)("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Linked"}):(0,r.jsx)("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:"No Account"})}),(0,r.jsx)("td",{className:"px-2 py-3 text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[n&&(0,r.jsx)(w,{onClick:()=>n(e),variant:"secondary",size:"sm",children:"Edit"}),l&&(0,r.jsx)(w,{onClick:()=>l(e.id),variant:"danger",size:"sm",children:"Delete"})]})})]},e.id)})})]})})})}function C(e){let{isOpen:t,onClose:s,onSave:n,attendant:l=null,loading:i=!1}=e,[c,o]=(0,a.useState)({firstName:"",lastName:"",email:"",phone:"",congregation:"",formsOfService:[],isActive:!0,notes:""}),[d,m]=(0,a.useState)({}),[x,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t&&(l?o({firstName:l.firstName,lastName:l.lastName,email:l.email,phone:l.phone||"",congregation:l.congregation,formsOfService:l.formsOfService,isActive:l.isActive,notes:l.notes||"",userId:l.userId||void 0}):o({firstName:"",lastName:"",email:"",phone:"",congregation:"",formsOfService:[],isActive:!0,notes:""}),m({}))},[t,l]);let h=()=>{let e={};return c.firstName.trim()||(e.firstName="First name is required"),c.lastName.trim()||(e.lastName="Last name is required"),c.email.trim()?/\S+@\S+\.\S+/.test(c.email)||(e.email="Please enter a valid email address"):e.email="Email is required",c.congregation.trim()||(e.congregation="Congregation is required"),0===c.formsOfService.length&&(e.formsOfService="At least one form of service is required"),m(e),0===Object.keys(e).length},p=async e=>{if(e.preventDefault(),h())try{u(!0),await n(c),s()}catch(e){}finally{u(!1)}},f=(e,t)=>{o(s=>({...s,[e]:t})),d[e]&&m(t=>({...t,[e]:""}))};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 xl:w-2/5 shadow-lg rounded-md bg-white",children:(0,r.jsx)("form",{onSubmit:p,children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:l?"Edit Attendant":"Create New Attendant"}),(0,r.jsx)("button",{type:"button",onClick:s,disabled:x,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:c.firstName,onChange:e=>f("firstName",e.target.value),disabled:x,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.firstName?"border-red-300":"border-gray-300"),placeholder:"Enter first name"}),d.firstName&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.firstName})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:c.lastName,onChange:e=>f("lastName",e.target.value),disabled:x,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.lastName?"border-red-300":"border-gray-300"),placeholder:"Enter last name"}),d.lastName&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.lastName})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"email",value:c.email,onChange:e=>f("email",e.target.value),disabled:x,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.email?"border-red-300":"border-gray-300"),placeholder:"Enter email address"}),d.email&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,r.jsx)("input",{type:"tel",value:c.phone,onChange:e=>f("phone",e.target.value),disabled:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Congregation ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:c.congregation,onChange:e=>f("congregation",e.target.value),disabled:x,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.congregation?"border-red-300":"border-gray-300"),placeholder:"Enter congregation name"}),d.congregation&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.congregation})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(g,{selectedForms:c.formsOfService,onChange:e=>f("formsOfService",e),disabled:x,required:!0}),d.formsOfService&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.formsOfService})]}),(0,r.jsx)("div",{children:(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:c.isActive,onChange:e=>f("isActive",e.target.checked),disabled:x,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Active (available for assignments)"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,r.jsx)("textarea",{value:c.notes,onChange:e=>f("notes",e.target.value),disabled:x,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional notes about this attendant"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[(0,r.jsx)(w,{onClick:s,variant:"secondary",disabled:x,children:"Cancel"}),(0,r.jsx)(w,{onClick:()=>{},type:"submit",variant:"primary",loading:x,disabled:x,children:l?"Update Attendant":"Create Attendant"})]})]})})})}):null}function A(e){var t;let{isOpen:s,onClose:n,onImport:l,eventId:i,loading:c=!1}=e,[o,d]=(0,a.useState)(""),[m,x]=(0,a.useState)(null),[u,g]=(0,a.useState)([]),[p,f]=(0,a.useState)([]),[v,j]=(0,a.useState)(!1),[b,N]=(0,a.useState)("input"),[y,k]=(0,a.useState)(null),[C,A]=(0,a.useState)("file"),S=e=>{try{let t=e.trim().split("\n"),s=t[0].split(",").map(e=>e.trim().replace(/"/g,"")),r=["firstName","lastName","email","congregation","formsOfService"].filter(e=>!s.includes(e));if(r.length>0){f(["Missing required columns: ".concat(r.join(", "))]);return}let a=[],n=[];for(let e=1;e<t.length;e++){let r=t[e].trim();if(!r)continue;let l=r.split(",").map(e=>e.trim().replace(/"/g,"")),i={};if(s.forEach((e,t)=>{i[e]=l[t]||""}),!i.firstName){n.push("Row ".concat(e+1,": First name is required"));continue}if(!i.lastName){n.push("Row ".concat(e+1,": Last name is required"));continue}if(!i.email||!/\S+@\S+\.\S+/.test(i.email)){n.push("Row ".concat(e+1,": Valid email is required"));continue}if(!i.congregation){n.push("Row ".concat(e+1,": Congregation is required"));continue}if(!i.formsOfService){n.push("Row ".concat(e+1,": Forms of service are required"));continue}let c=i.formsOfService.split(",").map(e=>e.trim()).filter(e=>!h.includes(e));if(c.length>0){n.push("Row ".concat(e+1,": Invalid forms of service: ").concat(c.join(", ")));continue}i.isActive="false"!==i.isActive,i.phone=i.phone||"",i.notes=i.notes||"",a.push(i)}if(n.length>0){f(n);return}g(a),f([]),N("preview")}catch(e){f(["Error parsing CSV data. Please check the format."])}},E=async()=>{try{j(!0);let e=await l({attendants:u,eventId:i});k(e),N("results")}catch(e){f([e instanceof Error?e.message:"Import failed"])}finally{j(!1)}},D=()=>{d(""),x(null),g([]),f([]),N("input"),k(null);let e=document.getElementById("csv-file-input");e&&(e.value="")},R=()=>{D(),n()};return s?(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-10 mx-auto p-5 border w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Bulk Import Attendants"}),(0,r.jsx)("button",{type:"button",onClick:R,disabled:v,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"flex items-center ".concat("input"===b?"text-blue-600":"text-green-600"),children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat("input"===b?"bg-blue-100":"bg-green-100"),children:"1"}),(0,r.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Input CSV"})]}),(0,r.jsx)("div",{className:"flex-1 h-px bg-gray-300 mx-4"}),(0,r.jsxs)("div",{className:"flex items-center ".concat("preview"===b?"text-blue-600":"results"===b?"text-green-600":"text-gray-400"),children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat("preview"===b?"bg-blue-100":"results"===b?"bg-green-100":"bg-gray-100"),children:"2"}),(0,r.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Preview"})]}),(0,r.jsx)("div",{className:"flex-1 h-px bg-gray-300 mx-4"}),(0,r.jsxs)("div",{className:"flex items-center ".concat("results"===b?"text-blue-600":"text-gray-400"),children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat("results"===b?"bg-blue-100":"bg-gray-100"),children:"3"}),(0,r.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Results"})]})]})}),"input"===b&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"CSV Format Requirements"}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-blue-700",children:[(0,r.jsx)("p",{children:"Required columns: firstName, lastName, email, congregation, formsOfService"}),(0,r.jsx)("p",{children:"Optional columns: phone, isActive, notes"}),(0,r.jsxs)("p",{children:["Forms of Service: ",h.join(", ")]})]})]})]})}),(0,r.jsxs)("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg mb-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>A("file"),className:"flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors ".concat("file"===C?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"\uD83D\uDCC1 Upload CSV File"}),(0,r.jsx)("button",{type:"button",onClick:()=>A("text"),className:"flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors ".concat("text"===C?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"\uD83D\uDCDD Paste CSV Text"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"file"===C?"CSV File Upload":"CSV Data"}),(0,r.jsx)(w,{onClick:()=>{let e=new Blob(['firstName,lastName,email,phone,congregation,formsOfService,isActive,notes\nJohn,Smith,john.smith@example.com,216-555-0123,Central Congregation,"Elder,Exemplary",true,Available for all assignments\nJane,Doe,jane.doe@example.com,216-555-0124,North Congregation,"Ministerial Servant,Regular Pioneer",true,\nMike,Johnson,mike.j@example.com,,South Congregation,"Other Department",false,Currently unavailable'],{type:"text/csv"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="attendant_import_template.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},variant:"secondary",size:"sm",children:"\uD83D\uDCE5 Download Template"})]}),"file"===C?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,r.jsxs)("label",{htmlFor:"csv-file-input",className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,r.jsx)("svg",{className:"w-8 h-8 mb-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"CSV files only"})]}),(0,r.jsx)("input",{id:"csv-file-input",type:"file",accept:".csv,text/csv",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){if("text/csv"!==s.type&&!s.name.endsWith(".csv")){f(["Please select a CSV file"]);return}x(s),f([])}},disabled:v,className:"hidden"})]})}),m&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-md",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-green-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{className:"text-sm text-green-800 font-medium",children:m.name}),(0,r.jsxs)("span",{className:"text-xs text-green-600 ml-2",children:["(",(m.size/1024).toFixed(1)," KB)"]})]}),(0,r.jsx)("button",{type:"button",onClick:()=>x(null),className:"text-green-600 hover:text-green-800 transition-colors",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):(0,r.jsx)("textarea",{value:o,onChange:e=>d(e.target.value),disabled:v,rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm",placeholder:"Paste your CSV data here or download the template to get started..."}),p.length>0&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-red-800",children:"Validation Errors"}),(0,r.jsx)("ul",{className:"mt-2 text-sm text-red-700 list-disc list-inside",children:p.map((e,t)=>(0,r.jsx)("li",{children:e},t))})]})]})})]}),"preview"===b&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h4",{className:"text-md font-medium text-gray-900",children:["Preview (",u.length," attendants)"]}),(0,r.jsx)(w,{onClick:()=>N("input"),variant:"secondary",size:"sm",children:"Back to Edit"})]}),(0,r.jsx)("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-md",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50 sticky top-0",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Congregation"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Forms of Service"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:[e.firstName," ",e.lastName]}),(0,r.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.email}),(0,r.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.congregation}),(0,r.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.formsOfService}),(0,r.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.isActive?"Active":"Inactive"})]},t))})]})})]}),"results"===b&&y&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"text-md font-medium text-gray-900",children:"Import Results"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:y.created||0}),(0,r.jsx)("div",{className:"text-sm text-green-800",children:"Created"})]})}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:y.updated||0}),(0,r.jsx)("div",{className:"text-sm text-blue-800",children:"Updated"})]})}),(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-600",children:(null===(t=y.errors)||void 0===t?void 0:t.length)||0}),(0,r.jsx)("div",{className:"text-sm text-red-800",children:"Errors"})]})})]}),y.errors&&y.errors.length>0&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-red-800 mb-2",children:"Import Errors"}),(0,r.jsx)("div",{className:"max-h-40 overflow-y-auto",children:y.errors.map((e,t)=>(0,r.jsxs)("div",{className:"text-sm text-red-700",children:["Row ",e.row," (",e.email,"): ",e.error]},t))})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:["input"===b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w,{onClick:R,variant:"secondary",children:"Cancel"}),(0,r.jsx)(w,{onClick:"file"===C?()=>{if(!m){f(["Please select a CSV file"]);return}let e=new FileReader;e.onload=e=>{var t;S(null===(t=e.target)||void 0===t?void 0:t.result)},e.onerror=()=>{f(["Error reading file"])},e.readAsText(m)}:()=>{if(!o.trim()){f(["Please enter CSV data"]);return}S(o)},variant:"primary",disabled:"file"===C?!m:!o.trim(),children:"file"===C?"Process File":"Parse CSV"})]}),"preview"===b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w,{onClick:()=>N("input"),variant:"secondary",children:"Back"}),(0,r.jsxs)(w,{onClick:E,variant:"primary",loading:v,disabled:v,children:["Import ",u.length," Attendants"]})]}),"results"===b&&(0,r.jsx)(w,{onClick:R,variant:"primary",children:"Done"})]})]})})}):null}function S(e){let{stats:t,loading:s=!1,className:a=""}=e;if(s)return(0,r.jsx)("div",{className:"bg-white rounded-lg shadow p-6 ".concat(a),children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded mb-4"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded"})]},t))})]})});let n=Object.entries(t.byCongregation).sort((e,t)=>{let[,s]=e,[,r]=t;return r-s}).slice(0,5),l=Object.entries(t.byFormsOfService).filter(e=>{let[,t]=e;return t>0}).sort((e,t)=>{let[,s]=e,[,r]=t;return r-s});return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow ".concat(a),children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Attendant Statistics"})}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Overview"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:t.total}),(0,r.jsx)("div",{className:"text-sm text-blue-800",children:"Total"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:t.active}),(0,r.jsx)("div",{className:"text-sm text-green-800",children:"Active"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-600",children:t.inactive}),(0,r.jsx)("div",{className:"text-sm text-red-800",children:"Inactive"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[Math.round(t.active/t.total*100)||0,"%"]}),(0,r.jsx)("div",{className:"text-sm text-purple-800",children:"Active Rate"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"User Accounts"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-xl font-bold text-green-600",children:t.withUsers}),(0,r.jsx)("div",{className:"text-sm text-green-800",children:"With Accounts"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-xl font-bold text-gray-600",children:t.withoutUsers}),(0,r.jsx)("div",{className:"text-sm text-gray-800",children:"No Account"})]})]})]}),l.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Forms of Service"}),(0,r.jsx)("div",{className:"space-y-2",children:l.map(e=>{let[s,a]=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(b,{form:s}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:s})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a}),(0,r.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(a/t.total*100,"%")}})})]})]},s)})})]}),n.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:["Top Congregations",Object.keys(t.byCongregation).length>5&&(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-1",children:"(showing top 5)"})]}),(0,r.jsx)("div",{className:"space-y-2",children:n.map(e=>{let[s,a]=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,r.jsx)("span",{className:"text-sm text-gray-700 truncate flex-1 mr-2",children:s}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a}),(0,r.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"".concat(a/t.total*100,"%")}})})]})]},s)})}),Object.keys(t.byCongregation).length>5&&(0,r.jsx)("div",{className:"text-center mt-2",children:(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["+",Object.keys(t.byCongregation).length-5," more congregations"]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Quick Insights"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,r.jsxs)("span",{children:[Object.keys(t.byCongregation).length," congregations represented"]})]}),t.withUsers>0&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,r.jsxs)("span",{children:[Math.round(t.withUsers/t.total*100),"% have user accounts"]})]}),l.length>0&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),(0,r.jsxs)("span",{children:["Most common: ",l[0][0]," (",l[0][1]," attendants)"]})]})]})]})]})]})}function E(e){let{eventId:t,eventName:s}=e;(0,n.useRouter)();let{data:i}=(0,l.useSession)(),{attendants:o,loading:m,error:u,pagination:h,stats:g,filters:f,eventInfo:v,setFilters:j,setPage:b,setPageSize:N,refresh:y,createAttendant:E,updateAttendant:D,deleteAttendant:R,bulkUpdateStatus:O,bulkDelete:I,bulkImport:U}=function(e){let{eventId:t,pageSize:s=25,includeStats:r=!0,initialFilters:n={}}=e,[l,i]=(0,a.useState)([]),[c,o]=(0,a.useState)(!1),[d,m]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),[g,p]=(0,a.useState)({eventId:t,eventName:void 0}),[f,v]=(0,a.useState)(n),[j,b]=(0,a.useState)({page:1,limit:s,total:0,pages:0}),N=(0,a.useCallback)(async()=>{if(!t){console.error("No eventId provided to useEventAttendants");return}try{var e,s;console.log("APEX GUARDIAN: fetchEventAttendants called with:"),console.log("- eventId:",t),console.log("- pagination:",j),console.log("- filters:",f),o(!0),m(null);let r=await x.getEventAttendants(t,{...f,page:j.page,limit:j.limit});console.log("APEX GUARDIAN: API response:",r),console.log("APEX GUARDIAN: Attendants returned:",(null===(s=r.data)||void 0===s?void 0:null===(e=s.attendants)||void 0===e?void 0:e.length)||0),r.success&&r.data?(i(r.data.attendants||[]),b(r.data.pagination||{page:1,limit:25,total:0,pages:0}),p({eventId:r.data.eventId||t,eventName:r.data.eventName}),r.data.stats?h(r.data.stats):h(null)):m(r.error||"Failed to fetch event attendants")}catch(t){let e=t instanceof Error?t.message:"An error occurred";console.error("APEX GUARDIAN: fetchEventAttendants error:",e),m(e)}finally{o(!1)}},[t,f,j.page,j.limit,r]),y=(0,a.useCallback)(e=>{console.log("APEX GUARDIAN: Setting page to:",e),b(t=>{let s={...t,page:e};return console.log("APEX GUARDIAN: New pagination state:",s),s})},[]),w=(0,a.useCallback)(e=>{console.log("APEX GUARDIAN: Setting page size to:",e),b(t=>{let s={...t,limit:-1===e?999999:e,page:1};return console.log("APEX GUARDIAN: New pagination state:",s),s})},[]),k=(0,a.useCallback)(async()=>{await N()},[N]),C=(0,a.useCallback)(async e=>{try{m(null);let s=await x.createEventAttendant(t,e);if(s.success)await k();else throw Error(s.error||"Failed to create attendant")}catch(t){let e=t instanceof Error?t.message:"Failed to create attendant";throw m(e),Error(e)}},[t,k]),A=(0,a.useCallback)(async(e,s)=>{try{m(null);let r=await x.updateEventAttendant(t,e,s);if(r.success)await k();else throw Error(r.error||"Failed to update attendant")}catch(t){let e=t instanceof Error?t.message:"Failed to update attendant";throw m(e),Error(e)}},[t,k]),S=(0,a.useCallback)(async e=>{try{if(m(null),(await x.deleteEventAttendant(t,e)).success)await k();else throw Error("Failed to delete attendant")}catch(t){let e=t instanceof Error?t.message:"Failed to delete attendant";throw m(e),Error(e)}},[t,k]),E=(0,a.useCallback)(async(e,s)=>{try{m(null),await x.bulkUpdateEventAttendantStatus(t,e,s),await k()}catch(t){let e=t instanceof Error?t.message:"Failed to bulk update status";throw m(e),Error(e)}},[t,k]),D=(0,a.useCallback)(async e=>{try{o(!0),m(null),i(t=>t.filter(t=>!e.includes(t.id)))}catch(e){m(e instanceof Error?e.message:"Failed to delete attendants")}finally{o(!1)}},[]),R=(0,a.useCallback)(async e=>{try{o(!0),m(null);let s=await x.bulkImportEventAttendants(t,e);s.success?await N():m(s.error||"Failed to import attendants")}catch(e){m(e instanceof Error?e.message:"Failed to import attendants")}finally{o(!1)}},[t,N]);return(0,a.useEffect)(()=>{t&&N()},[N]),{attendants:l,loading:c,error:d,pagination:j,stats:u,filters:f,eventInfo:g,setFilters:v,setPage:y,setPageSize:w,refresh:k,createAttendant:C,updateAttendant:A,deleteAttendant:S,bulkUpdateStatus:E,bulkDelete:D,bulkImport:R}}({eventId:t,pageSize:25,includeStats:!0});(0,a.useEffect)(()=>{M(Array.from(new Set(o.map(e=>e.congregation).filter(Boolean))).sort())},[o]);let[L,M]=(0,a.useState)([]),[P,F]=(0,a.useState)([]),[B,z]=(0,a.useState)(!1),[T,V]=(0,a.useState)(!1),[W,X]=(0,a.useState)(null),G=(null==i?void 0:i.user)&&["ADMIN","OVERSEER"].includes(i.user.role),_=()=>{z(!1),X(null)},q=async e=>{try{W?await D(W.id,e):await E(e),_()}catch(e){console.error("Error saving attendant:",e)}},J=async e=>{if(confirm("Are you sure you want to delete this attendant?"))try{await R(e)}catch(e){console.error("Error deleting attendant:",e)}},H=async(e,t)=>{try{await O(e,t),F([])}catch(e){console.error("Error updating attendant status:",e)}},Z=async e=>{if(confirm("Are you sure you want to delete ".concat(e.length," attendant(s)?")))try{await I(e),F([])}catch(e){console.error("Error deleting attendants:",e)}},K=async e=>{try{await U(e),V(!1)}catch(e){console.error("Error importing attendants:",e)}};return G?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(c(),{children:(0,r.jsxs)("title",{children:[v.eventName||s||"Event"," - Attendants | JW Attendant Scheduler"]})}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Event Attendants"}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Manage attendants for ",v.eventName||s||"this event"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(d(),{href:"/events/".concat(t),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"â† Back to Event"}),(0,r.jsx)(w,{onClick:()=>V(!0),variant:"secondary",size:"sm",children:"Bulk Import"}),(0,r.jsx)(w,{onClick:()=>{X(null),z(!0)},variant:"primary",size:"sm",children:"Add Attendant"})]})]}),g&&(0,r.jsx)(S,{stats:g,loading:m}),(0,r.jsx)(p,{filters:f,onFiltersChange:j,congregations:L,loading:m}),u&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,r.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,r.jsx)("p",{children:u})})]})]})}),P.length>0&&(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:[P.length," attendant(s) selected"]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(w,{onClick:()=>F([]),variant:"secondary",size:"sm",children:"Clear Selection"}),(0,r.jsx)(w,{onClick:()=>H(P,!0),variant:"success",size:"sm",children:"Activate Selected"}),(0,r.jsx)(w,{onClick:()=>H(P,!1),variant:"secondary",size:"sm",children:"Deactivate Selected"}),(0,r.jsx)(w,{onClick:()=>Z(P),variant:"danger",size:"sm",children:"Delete Selected"})]})]})}),(0,r.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,r.jsx)(k,{attendants:o,loading:m,onEdit:e=>{X(e),z(!0)},onDelete:J,onSelect:F,selectedIds:P,onBulkStatusChange:H})}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 py-4 bg-white rounded-lg shadow px-4",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing ",(h.page-1)*h.limit+1," to"," ",Math.min(h.page*h.limit,h.total)," of"," ",h.total," results"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("label",{htmlFor:"pageSize",className:"text-sm text-gray-700",children:"Show:"}),(0,r.jsxs)("select",{id:"pageSize",value:999999===h.limit?-1:h.limit,onChange:e=>{console.log("APEX GUARDIAN: Select changed, setPageSize function:",typeof N),console.log("APEX GUARDIAN: New value:",e.target.value),e.preventDefault(),N(Number(e.target.value))},disabled:m,className:"border border-gray-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:10,children:"10"}),(0,r.jsx)("option",{value:25,children:"25"}),(0,r.jsx)("option",{value:50,children:"50"}),(0,r.jsx)("option",{value:100,children:"100"}),(0,r.jsx)("option",{value:-1,children:"All"})]}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:"per page"})]})]}),h.pages>1&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(w,{onClick:()=>{console.log("APEX GUARDIAN: Previous button clicked, setPage function:",typeof b),console.log("APEX GUARDIAN: Current pagination:",h),b(h.page-1)},disabled:h.page<=1||m,variant:"secondary",size:"sm",type:"button",children:"Previous"}),(0,r.jsxs)("span",{className:"px-3 py-1 text-sm text-gray-700",children:["Page ",h.page," of ",h.pages]}),(0,r.jsx)(w,{onClick:()=>{console.log("APEX GUARDIAN: Next button clicked, setPage function:",typeof b),console.log("APEX GUARDIAN: Current pagination:",h),b(h.page+1)},disabled:h.page>=h.pages||m,variant:"secondary",size:"sm",type:"button",children:"Next"})]})]}),(0,r.jsx)(C,{isOpen:B,onClose:_,onSave:q,attendant:W}),(0,r.jsx)(A,{isOpen:T,onClose:()=>V(!1),onImport:K})]}):(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to manage attendants."}),(0,r.jsx)(d(),{href:"/events",className:"text-blue-600 hover:text-blue-800",children:"Return to Events"})]})})}var D=s(5083);class R extends a.Component{static getDerivedStateFromError(e){return console.error("APEX GUARDIAN: Error boundary caught error:",e),{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){console.error("APEX GUARDIAN: Error boundary componentDidCatch:",e,t),this.setState({error:e,errorInfo:t})}render(){if(this.state.hasError){var e;return(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-red-900 mb-4",children:"\uD83D\uDEE1ï¸ APEX GUARDIAN Error Boundary"}),(0,r.jsx)("p",{className:"text-red-600 mb-4",children:"A React error was caught and contained:"}),(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-4 mb-4 text-left",children:[(0,r.jsx)("p",{className:"font-mono text-sm text-red-800",children:(null===(e=this.state.error)||void 0===e?void 0:e.message)||"Unknown error"}),this.state.errorInfo&&(0,r.jsxs)("details",{className:"mt-2",children:[(0,r.jsx)("summary",{className:"cursor-pointer text-red-700",children:"Stack Trace"}),(0,r.jsx)("pre",{className:"mt-2 text-xs text-red-600 overflow-auto",children:this.state.errorInfo.componentStack})]})]}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Reload Page"})]})})}return this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}}var O=!0;function I(e){let{eventId:t,event:s}=e;return(0,r.jsx)(D.Z,{title:"".concat((null==s?void 0:s.name)||"Event"," - Attendants | JW Attendant Scheduler"),breadcrumbs:[{label:"Events",href:"/events"},{label:(null==s?void 0:s.name)||"Event",href:"/events/".concat(t)},{label:"Attendants"}],selectedEvent:{id:t,name:(null==s?void 0:s.name)||"Event",status:null==s?void 0:s.status},children:(0,r.jsx)(R,{children:(0,r.jsx)(E,{eventId:t,eventName:null==s?void 0:s.name})})})}},9008:function(e,t,s){e.exports=s(3867)}},function(e){e.O(0,[424,888,774,179],function(){return e(e.s=9781)}),_N_E=e.O()}]);