(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[695],{5378:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/events",function(){return s(9630)}])},5083:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});var a=s(5893),r=s(3299),l=s(1664),n=s.n(l),i=s(1163);function c(e){var t,s;let{children:l,title:c="JW Attendant Scheduler",breadcrumbs:d=[],selectedEvent:o}=e,{data:x}=(0,r.useSession)(),u=(0,i.useRouter)(),m=[{label:"Events",href:"/events",icon:"\uD83D\uDCC5",roles:["ADMIN","OVERSEER","ATTENDANT"]},{label:"Event Selection",href:"/events/select",icon:"\uD83C\uDFAF",roles:["ADMIN","OVERSEER","ATTENDANT"]}];["ADMIN","OVERSEER"].includes((null==x?void 0:null===(t=x.user)||void 0===t?void 0:t.role)||"")&&m.push({label:"Attendants",href:"/attendants",icon:"\uD83D\uDC65",roles:["ADMIN","OVERSEER"]}),(null==x?void 0:null===(s=x.user)||void 0===s?void 0:s.role)==="ADMIN"&&m.push({label:"Admin Portal",href:"/admin",icon:"\uD83D\uDEE1️",roles:["ADMIN"]});let h=m.filter(e=>{var t;return e.roles.includes((null==x?void 0:null===(t=x.user)||void 0===t?void 0:t.role)||"")});return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)(n(),{href:"/events/select",className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:"\uD83D\uDCCB"}),(0,a.jsx)("span",{className:"ml-2 text-xl font-semibold text-gray-900",children:"JW Attendant Scheduler"})]}),(0,a.jsx)("div",{className:"hidden md:ml-8 md:flex md:space-x-4",children:h.map(e=>(0,a.jsxs)(n(),{href:e.href,className:"px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat(u.pathname.startsWith(e.href)?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.href))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[o&&(0,a.jsxs)("div",{className:"hidden md:flex items-center bg-blue-50 px-3 py-1 rounded-lg",children:[(0,a.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["\uD83D\uDCC5 ",o.name]}),o.status&&(0,a.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full ".concat("current"===o.status?"bg-green-100 text-green-800":"upcoming"===o.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:o.status})]}),(null==x?void 0:x.user)&&(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-sm text-gray-700",children:x.user.name}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("ADMIN"===x.user.role?"bg-red-100 text-red-800":"OVERSEER"===x.user.role?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:x.user.role}),(0,a.jsx)("button",{onClick:()=>{(0,r.signOut)({callbackUrl:"/auth/signin"})},className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"Sign Out"})]})]})]})})}),d.length>0&&(0,a.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:(0,a.jsx)("nav",{className:"flex","aria-label":"Breadcrumb",children:(0,a.jsx)("ol",{className:"flex items-center space-x-2",children:d.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center",children:[t>0&&(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-400 mx-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.href?(0,a.jsx)(n(),{href:e.href,className:"text-sm text-blue-600 hover:text-blue-800",children:e.label}):(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.label})]},t))})})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c&&(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:c})}),l]})]})}},9630:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return o},default:function(){return x}});var a=s(5893),r=s(3299),l=s(5083),n=s(7294),i=s(1664),c=s.n(i),d=s(1163),o=!0;function x(){var e;let{data:t,status:s}=(0,r.useSession)(),i=(0,d.useRouter)(),[o,x]=(0,n.useState)([]),[u,m]=(0,n.useState)(!0),[h,p]=(0,n.useState)(""),[g,v]=(0,n.useState)({page:1,limit:10,total:0,pages:0,hasNext:!1,hasPrev:!1}),[b,N]=(0,n.useState)(""),[j,f]=(0,n.useState)(""),[y,E]=(0,n.useState)(""),[D,w]=(0,n.useState)("startDate"),[C,S]=(0,n.useState)("desc"),A=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{m(!0);let t=new URLSearchParams({page:e.toString(),limit:g.limit.toString(),search:b,eventType:j,status:y,sortBy:D,sortOrder:C}),s=await fetch("/api/events?".concat(t));if(401===s.status){m(!1),i.push("/auth/signin");return}let a=await s.json();a.success?(x(a.data.events),v(a.data.pagination),p("")):p("Failed to fetch events")}catch(e){p("Error fetching events"),console.error("Error:",e)}finally{m(!1)}};(0,n.useEffect)(()=>{A()},[b,j,y,D,C]);let T=e=>{if(!e)return"No date";try{let[t,s,a]=e.split("T")[0].split("-");return new Date(parseInt(t),parseInt(s)-1,parseInt(a)).toLocaleDateString()}catch(e){return"Invalid date"}},R=e=>new Date("2000-01-01T".concat(e)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),I=async(e,t)=>{if(confirm('Are you sure you want to delete "'.concat(t,'"? This action cannot be undone.')))try{let t=await fetch("/api/events/".concat(e),{method:"DELETE"});if(t.ok)A(),alert("Event deleted successfully");else{let e=await t.json();alert("Failed to delete event: ".concat(e.error))}}catch(e){console.error("Delete error:",e),alert("Failed to delete event")}},_=e=>({DRAFT:"bg-gray-100 text-gray-800",PUBLISHED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800",COMPLETED:"bg-blue-100 text-blue-800"})[e]||"bg-gray-100 text-gray-800",k=e=>({CIRCUIT_ASSEMBLY:"Circuit Assembly",REGIONAL_CONVENTION:"Regional Convention",SPECIAL_EVENT:"Special Event",OTHER:"Other"})[e]||e;return(0,a.jsx)(l.Z,{title:"Events Management",breadcrumbs:[{label:"Events",href:"/events"}],children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Manage events, assignments, and attendant scheduling"})}),(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.role)==="ADMIN"&&(0,a.jsx)(c(),{href:"/events/create",className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"➕ Create Event"})]})}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),A(1)},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,a.jsx)("input",{type:"text",id:"search",value:b,onChange:e=>N(e.target.value),placeholder:"Search events...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"eventType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Type"}),(0,a.jsxs)("select",{id:"eventType",value:j,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Types"}),(0,a.jsx)("option",{value:"CIRCUIT_ASSEMBLY",children:"Circuit Assembly"}),(0,a.jsx)("option",{value:"REGIONAL_CONVENTION",children:"Regional Convention"}),(0,a.jsx)("option",{value:"SPECIAL_EVENT",children:"Special Event"}),(0,a.jsx)("option",{value:"OTHER",children:"Other"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsxs)("select",{id:"status",value:y,onChange:e=>E(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Statuses"}),(0,a.jsx)("option",{value:"UPCOMING",children:"Upcoming"}),(0,a.jsx)("option",{value:"CURRENT",children:"Current"}),(0,a.jsx)("option",{value:"COMPLETED",children:"Completed"}),(0,a.jsx)("option",{value:"ARCHIVED",children:"Archived"}),(0,a.jsx)("option",{value:"CANCELLED",children:"Cancelled"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"sortBy",className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),(0,a.jsxs)("select",{id:"sortBy",value:D,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"startDate",children:"Start Date"}),(0,a.jsx)("option",{value:"name",children:"Name"}),(0,a.jsx)("option",{value:"eventType",children:"Type"}),(0,a.jsx)("option",{value:"status",children:"Status"}),(0,a.jsx)("option",{value:"createdAt",children:"Created"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{type:"submit",className:"w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"\uD83D\uDD0D Search"})})]})}),h&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,a.jsx)("p",{className:"text-red-700",children:h})}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:u?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading events..."})]}):0===o.length?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"No events found"}),(0,a.jsx)(c(),{href:"/events/create",className:"mt-4 inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"Create First Event"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Event"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assignments"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(e=>{var s;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),e.description&&(0,a.jsx)("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:e.description})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k(e.eventType)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:T(e.startDate)}),(0,a.jsxs)("div",{className:"text-gray-500",children:[R(e.startTime),e.endTime&&" - ".concat(R(e.endTime))]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:(0,a.jsx)("div",{className:"max-w-xs truncate",children:e.location})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(_(e.status)),children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:[e._count.assignments," assigned"]}),(0,a.jsxs)("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs",children:[e._count.event_positions," positions"]})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[(0,a.jsx)(c(),{href:"/events/".concat(e.id),className:"text-blue-600 hover:text-blue-900 transition-colors",children:"\uD83D\uDCCB Manage"}),(null==t?void 0:null===(s=t.user)||void 0===s?void 0:s.role)&&["ADMIN","OVERSEER"].includes(t.user.role)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c(),{href:"/events/".concat(e.id,"/edit"),className:"text-green-600 hover:text-green-900 transition-colors",children:"✏️ Edit"}),"ADMIN"===t.user.role&&(0,a.jsx)("button",{onClick:()=>I(e.id,e.name),className:"text-red-600 hover:text-red-900 transition-colors ml-2",children:"\uD83D\uDDD1️ Delete"})]})]})]},e.id)})})]})}),g.pages>1&&(0,a.jsx)("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing page ",g.page," of ",g.pages," (",g.total," total events)"]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>A(g.page-1),disabled:!g.hasPrev,className:"px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300",children:"Previous"}),(0,a.jsx)("span",{className:"px-3 py-1 text-sm bg-blue-600 text-white rounded",children:g.page}),(0,a.jsx)("button",{onClick:()=>A(g.page+1),disabled:!g.hasNext,className:"px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300",children:"Next"})]})]})})]})}),(0,a.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(c(),{href:"/events/create",className:"flex flex-col items-center space-y-2 p-4 rounded-lg border border-gray-200 hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl",children:"➕"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Create Event"})]}),(0,a.jsxs)("button",{onClick:()=>A(g.page),className:"flex flex-col items-center space-y-2 p-4 rounded-lg border border-gray-200 hover:border-gray-500 hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD04"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Refresh"})]}),(0,a.jsxs)(c(),{href:"/admin/events/import",className:"flex flex-col items-center space-y-2 p-4 rounded-lg border border-gray-200 hover:border-green-500 hover:bg-green-50 transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCE5"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Import Events"})]}),(0,a.jsxs)(c(),{href:"/admin/events/reports",className:"flex flex-col items-center space-y-2 p-4 rounded-lg border border-gray-200 hover:border-purple-500 hover:bg-purple-50 transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCCA"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Reports"})]})]})]})})}}},function(e){e.O(0,[424,888,774,179],function(){return e(e.s=5378)}),_N_E=e.O()}]);